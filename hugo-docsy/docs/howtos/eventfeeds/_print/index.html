<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.84.4" /><link rel="canonical" type="text/html" href="https://gchq.github.io/stroom-docs/hugo-docsy/docs/howtos/eventfeeds/">
<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="shortcut icon" href="/stroom-docs/hugo-docsy/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/stroom-docs/hugo-docsy/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/stroom-docs/hugo-docsy/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/stroom-docs/hugo-docsy/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/stroom-docs/hugo-docsy/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/stroom-docs/hugo-docsy/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/stroom-docs/hugo-docsy/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/stroom-docs/hugo-docsy/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/stroom-docs/hugo-docsy/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/stroom-docs/hugo-docsy/favicons/android-192x192.png" sizes="192x192">

<title>Event Feeds | Stroom</title>
<meta name="description" content="A Stroom example site"><meta property="og:title" content="Event Feeds" />
<meta property="og:description" content="A Stroom example site" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://gchq.github.io/stroom-docs/hugo-docsy/docs/howtos/eventfeeds/" /><meta property="og:site_name" content="Stroom" />

<meta itemprop="name" content="Event Feeds">
<meta itemprop="description" content="A Stroom example site"><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Event Feeds"/>
<meta name="twitter:description" content="A Stroom example site"/>




<link rel="preload" href="/stroom-docs/hugo-docsy/scss/main.min.483b37455a06bc1122dc23fe9270a6eb0a29bfc6feb0659f6856c91ce1142d2e.css" as="style">
<link href="/stroom-docs/hugo-docsy/scss/main.min.483b37455a06bc1122dc23fe9270a6eb0a29bfc6feb0659f6856c91ce1142d2e.css" rel="stylesheet" integrity="">


<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>

<script
  src="https://unpkg.com/lunr@2.3.8/lunr.min.js"
  integrity="sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY"
  crossorigin="anonymous"></script>





  </head>
  <body class="td-section">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/stroom-docs/hugo-docsy/">
		<span class="navbar-logo"><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="110.61089" height="30.000004" viewBox="0 0 88.488641 23.999957" id="svg2" inkscape:version="0.91 r13725" sodipodi:docname="logo.svg"><defs id="defs20"/><sodipodi:namedview pagecolor="#989898" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="1920" inkscape:window-height="1137" id="namedview18" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:zoom="5.5951814" inkscape:cx="55.451414" inkscape:cy="16.275348" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="1" inkscape:current-layer="svg2"/><g id="g4150" style="opacity:.97000002" transform="matrix(0.03883584,0,0,0.03883584,0,-3.1155874e-4)"><path id="path6" d="M121.99991 205.98497C54.999958 205.98497.0 259.98493.0 327.98487c0 66.99994 54.999958 121.99989 121.99991 121.99989h167.99987c24.99998.0 44.99996 20.99998 44.99996 44.99996.0 24.99998-19.99998 44.99996-44.99996 44.99996H109.20929C65.984126 553.87219 27.100843 581.57313.01093599 617.98462H289.99978c66.99994.0 121.99991-54.99996 121.99991-122.9999.0-66.99994-54.99997-121.99989-121.99991-121.99989H121.99991c-24.999984.0-44.999969-19.99999-44.999969-44.99996.0-24.99998 19.999985-44.99996 44.999969-44.99996h228.79045c26.9905-35.88325 65.47093-63.18547 108.21554-76.99994H121.99991z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path8" d="M601.44485-.00077860649C572.6583 8.3697982 546.49491 22.822962 524.44491 41.902305V205.78969l.002.19528h-.002c-65.11 48e-5-123.03145 30.0199-160.74675 76.99994h160.74675v334.99971h76.99994V282.98491h144.85298c27.16134-36.05885 65.96411-63.39275 109.02184-76.99994H601.44485v-205.98574860649z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path10" d="m919.42586 205.98497c-113.99519.0-205.99537 92.00648-206.00296 205.99982-15e-5 68.67178.0 137.32749.0 205.99983h77.99994c-.012-68.6493.0176-137.46869.0-205.99983.0846-70.92785 57.05747-128.99988 128.00462-128.99988 5.28623.0 10.49823.32864 15.62183.95311 18.2219-24.51229 41.78461-45.0838 68.42501-60.15146-25.65065-11.43799-54.08662-17.80159-84.04684-17.80159z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path12" d="m1109.4153 205.98457c-113.99994.0-205.99983 91.99993-205.99983 205.99984.0 112.9999 91.99989 205.9998 205.99983 205.9998 114 0 205.9999-92.9999 205.9999-205.9998.0-113.99991-91.9999-205.99984-205.9999-205.99984zm0 333.99974c-70.9999.0-128.99994-56.99996-128.99994-127.9999.0-70.99995 58.00004-128.9999 128.99994-128.9999 71 0 128.9999 57.99995 128.9999 128.9999.0 70.99994-57.9999 127.9999-128.9999 127.9999z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path14" d="m1444.4737 205.98457c-113.9999.0-205.9998 91.99993-205.9998 205.99984.0 112.9999 91.9999 205.9998 205.9998 205.9998s205.9999-92.9999 205.9999-205.9998c0-113.99991-92-205.99984-205.9999-205.99984zm0 333.99974c-70.9999.0-128.9999-56.99996-128.9999-127.9999.0-70.99995 58-128.9999 128.9999-128.9999 71 0 128.9999 57.99995 128.9999 128.9999.0 70.99994-57.9999 127.9999-128.9999 127.9999z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path16" d="m1738.5308 379.98447c0-53 43-97 95.9999-97 53 0 97 44 97 97v237.9997h76.9999v-237.9997c0-53 43-97 96.9999-97 53 0 95.9999 44 95.9999 97v237.9997h77v-237.9997c0-96-77-173.9999-172.9999-173.9999-54.9999.0-103.9999 24.99998-135.9999 64.99995-31.9999-39.99997-79.9999-64.99995-134.9999-64.99995-95.9999.0-173.9998 77.9999-173.9998 173.9999v237.9997h77.9999z" style="fill:#fff" inkscape:connector-curvature="0"/></g></svg></span><span class="text-uppercase font-weight-bold">Stroom</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/stroom-docs/hugo-docsy/about/" ><span>About</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link active" href="/stroom-docs/hugo-docsy/docs/" ><span class="active">Documentation</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/stroom-docs/hugo-docsy/news/" ><span>News / Releases</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/stroom-docs/hugo-docsy/community/" ><span>Community</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/stroom-docs/hugo-docsy/docs/style-guide/" ><span>Style Guide (DRAFT)</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/stroom-docs/hugo-docsy/all-content/" ><span>All Content (DRAFT)</span></a>
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block">



<input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this site…"
  aria-label="Search this site…"
  autocomplete="off"
  
  data-offline-search-index-json-src="/stroom-docs/hugo-docsy/offline-search-index.d35a372ed0d4223f1bbdd6cc334b5ce8.json"
  data-offline-search-base-href="/"
  data-offline-search-max-results="50"
>

</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/stroom-docs/hugo-docsy/docs/howtos/eventfeeds/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Event Feeds</h1>





    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-94737f87c4d0d4f24b4d2f0f041cecbb">Apache HTTPD Event Feed</a></li>


    
  
    
    
	
<li>2: <a href="#pg-819ae27ddbe9037ce3d20bee44a67c5e">Event Processing</a></li>


    
  

    </ul>


<div class="content">
      
</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-94737f87c4d0d4f24b4d2f0f041cecbb">1 - Apache HTTPD Event Feed</h1>
    <div class="lead">The following will take you through the process of creating an Event Feed in Stroom.</div>
	<p>In this example, the logs are in a well-defined, line based, text format so we will use a Data Splitter parser to transform the logs into simple record-based XML and then a XSLT translation to normalise them into the Event schema.</p>
<p>A separate document will describe the method of automating the storage of normalised events for this feed. Further, we will not Decorate these events. Again, Event Decoration is described in another document.</p>
<p>Author: John Doe<br>
Last Updated: 7 Mar 2020<br>
Recommended Additional Documentation:
HOWTO - Enabling Processors for a Pipeline</p>
<h2 id="event-log-source">Event Log Source</h2>
<p>For this example, we will use logs from an Apache HTTPD Web server. In fact, the web server in front of Stroom.</p>
<p>To get the optimal information from the Apache HTTPD access logs, we define our log format based on an extension of the BlackBox format. The format is described and defined below. This is an extract from a httpd configuration file (/etc/httpd/conf/httpd.conf)</p>
<pre><code>#  Stroom - Black  Box  Auditing configuration
#
#  %a  - Client  IP address  (not  hostname (%h) to ensure ip address only)
#  When  logging the remote host,  it is important to log the client  IP address, not the
#  hostname. We do   this  with the '%a' directive.  Even  if HostnameLookups  are turned on,
#  using '%a' will  only record the IP address.  For the purposes of BlackBox formats,
#  reversed DNS should not  be trusted

#  %{REMOTE_PORT}e  - Client source port
#  Logging the client  source TCP  port  can provide some   useful  network data and can help
#  one associate a single client  with multiple requests.
#  If two   clients from the  same IP address  make   simultaneous connections, the 'common  log'
#  file format cannot distinguish  between those  clients. Otherwise, if  the client uses
#  keep-alives, then every hit  made   from a single  TCP  session will  be associated  by   the  same
#  client  port number.
#  The   port information can indicate  how  many   connections our server is  handling at  once,
#  which may  help in tuning server TCP/OP   settings. It will also identify which client ports
#  are legitimate requests if  the administrator is examining a possible  SYN-attack against  a
#  server.
#  Note we  are using the REMOTE_PORT  environment variable. Environment variables  only come
#  into play when   mod_cgi or  mod_cgid is  handling the request.

#  %X   - Connection status  (use %c  for  Apache 1.3)
#  The   connection status  directive  tells us detailed  information about the client  connection.
#  It returns  one of three flags:
#  x  if the client aborted the connection before completion,
#  +  if  the client has indicated that it will  use keep-alives (and request additional  URLS),
#  - if the connection will  be closed after  the event
#  Keep-Alive is a HTTP 1.1.  directive  that  informs a web  server that  a client  can request multiple
#  files during the  same connection.  This way  a client  doesn't need to go   through the  overhead
#  of re-establishing  a TCP  connection to retrieve  a new  file.

#  %t  - time - or  [%{%d/%b/%Y:%T}t.%{msec_frac}t %{%z}t] for  Apache 2.4
#  The   %t  directive  records the time that  the request started.
#  NOTE:  When  deployed on   an  Apache 2.4, or better,  environment, you   should use
#  strftime  format in  order  to  get  microsecond resolution.

#  %l  - remote logname

#  %u - username [in quotes]
#  The   remote user  (from auth;  This may  be bogus if the return status  (%s) is  401
#  for non-ssl services)
#  For SSL  services,  user names need to  be delivered  as DNs  to deliver PKI   user details
#  in full.  To  pass through PKI   certificate  properties in the correct form you   need to
#  add the following directives  to your  Apache configuration:
# 	SSLUserName   SSL_CLIENT_S_DN
# 	SSLOptions +StdEnvVars
#  If you   cannot,  then use %{SSL_CLIENT_S_DN}x   in place of %u and use  blackboxSSLUser
#  LogFormat nickname

#  %r  - first  line of text sent by   web  client [in quotes]
#  This is the first  line of text send by   the web  client, which includes the request
#  method, the  full URL,  and the  HTTP protocol.

#  %s  - status  code before any redirection
#  This is  the status  code of the original request.

#  %&gt;s  - status  code after  any redirection  has taken place
 
#  This is  the final  status  code of the request, after  any internal  redirections  may
#  have taken  place.

#  %D   - time in  microseconds to handle the request
#  This is the  number of microseconds the  server  took to  handle the  request  in  microseconds

#  %I  - incoming bytes
#  This is  the bytes received, include request and headers. It  cannot, by   definition be zero.

#  %O   - outgoing bytes
#  This is  the size in bytes of the outgoing data,  including HTTP headers. It  cannot,  by
#  definition be zero.

#  %B  - outgoing content bytes
#  This is  the size in bytes of the outgoing data,  EXCLUDING  HTTP headers.  Unlike %b,   which
#  records '-' for zero bytes transferred,  %B  will record '0'.

#  %{Referer}i - Referrer HTTP Request  Header [in quotes]
#  This is  typically the URL of the page that  made   the request.  If  linked from
#  e-mail or direct  entry this  value will be empty. Note, this  can be spoofed
#  or turned off

#  %{User-Agent}i - User agent HTTP Request  Header [in quotes]
#  This is  the identifying information the client  (browser) reports about itself.
#  It can be spoofed or  turned  off

#  %V   - the server name   according to the UseCannonicalName setting
#  This identifies  the virtual  host in a multi host webservice

#  %p - the canonical port of the server servicing the request

#  Define a variation  of the Black Box  logs
#
#  Note, you   only need to  use the  'blackboxSSLUser' nickname if you   cannot set  the
#  following directives  for any SSL  configurations
#  SSLUserName   SSL_CLIENT_S_DN
#  SSLOptions +StdEnvVars
#  You  will also note the variation for no   logio  module. The   logio  module supports
#  the %I  and %O   formatting directive
#

&lt;IfModule mod_logio.c&gt;
   LogFormat &quot;%a/%{REMOTE_PORT}e %X %t %l \&quot;../../&quot;%r\&quot; %s/%&gt;s %D %I/%O/%B \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %V/%p&quot; blackboxUser
   LogFormat &quot;%a/%{REMOTE_PORT}e %X %t %l \&quot;%{SSL_CLIENT_S_DN../../&quot;%r\&quot; %s/%&gt;s %D %I/%O/%B \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %V/%p&quot; blackboxSSLUser
&lt;/IfModule&gt;
&lt;IfModule !mod_logio.c&gt;
   LogFormat &quot;%a/%{REMOTE_PORT}e %X %t %l \&quot;../../&quot;%r\&quot; %s/%&gt;s %D 0/0/%B \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %V/$p&quot; blackboxUser
   LogFormat &quot;%a/%{REMOTE_PORT}e %X %t %l \&quot;%{SSL_CLIENT_S_DN../../&quot;%r\&quot; %s/%&gt;s %D 0/0/%B \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %V/$p&quot; blackboxSSLUser
&lt;/IfModule&gt;

</code></pre><p>A copy of this configuration can be found <a href="ApacheHTTPDAuditConfig.txt" title="Apache BlackBox Auditing Configuration">here</a>.</p>
<p>As Stroom can use PKI for login, you can configure Stroom’s Apache to make use of the blackboxSSLUser log format. A sample set of logs in this format appear below.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">192.168.4.220/61801 - [18/Jan/2020:12:39:04 -0800] - &#34;/C=USA/ST=CA/L=Los Angeles/O=Default Company Ltd/CN=Burn Frank (burn)&#34; &#34;POST /accounting/ui/dispatch.rpc HTTP/1.1&#34; 200/200 21221 2289/415/14 &#34;https://host01.company4.org/accounting/&#34; &#34;Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.99 Safari/537.36&#34; host01.company4.org/443
192.168.4.220/61854 - [18/Jan/2020:12:40:04 -0800] - &#34;/C=USA/ST=CA/L=Los Angeles/O=Default Company Ltd/CN=Burn Frank (burn)&#34; &#34;POST /accounting/ui/dispatch.rpc HTTP/1.1&#34; 200/200 7889 2289/415/14 &#34;https://host01.company4.org/accounting/&#34; &#34;Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.99 Safari/537.36&#34; host01.company4.org/443
192.168.4.220/61909 - [18/Jan/2020:12:41:04 -0800] - &#34;/C=USA/ST=CA/L=Los Angeles/O=Default Company Ltd/CN=Burn Frank (burn)&#34; &#34;POST /accounting/ui/dispatch.rpc HTTP/1.1&#34; 200/200 6901 2389/3796/14 &#34;https://host01.company4.org/accounting/&#34; &#34;Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.99 Safari/537.36&#34; host01.company4.org/443
192.168.4.220/61962 - [18/Jan/2020:12:42:04 -0800] - &#34;/C=USA/ST=CA/L=Los Angeles/O=Default Company Ltd/CN=Burn Frank (burn)&#34; &#34;POST /accounting/ui/dispatch.rpc HTTP/1.1&#34; 200/200 11219 2289/415/14 &#34;https://host01.company4.org/accounting/&#34; &#34;Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.99 Safari/537.36&#34; host01.company4.org/443
192.168.3.117/62015 - [18/Jan/2020:12:43:04 -1000] - &#34;/C=AUS/ST=NSW/L=Sydney/O=Default Company Ltd/CN=Max Bergman (maxb)&#34; &#34;POST /accounting/ui/dispatch.rpc HTTP/1.1&#34; 200/200 4265 2289/415/14 &#34;https://stroomnode01.strmdev01.org/accounting/&#34; &#34;Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.99 Safari/537.36&#34; stroomnode01.strmdev01.org/443
192.168.3.117/62092 - [18/Jan/2020:12:44:04 -1000] - &#34;/C=AUS/ST=NSW/L=Sydney/O=Default Company Ltd/CN=Max Bergman (maxb)&#34; &#34;POST /accounting/ui/dispatch.rpc HTTP/1.1&#34; 200/200 9791 2289/415/14 &#34;https://stroomnode01.strmdev01.org/accounting/&#34; &#34;Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.99 Safari/537.36&#34; stroomnode01.strmdev01.org/443
192.168.3.117/62147 - [18/Jan/2020:12:44:04 -1000] - &#34;/C=AUS/ST=NSW/L=Sydney/O=Default Company Ltd/CN=Max Bergman (maxb)&#34; &#34;POST /accounting/ui/dispatch.rpc HTTP/1.1&#34; 200/200 11509 2289/415/14 &#34;https://stroomnode01.strmdev01.org/accounting/&#34; &#34;Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.99 Safari/537.36&#34; stroomnode01.strmdev01.org/443
192.168.3.117/62202 - [18/Jan/2020:12:44:04 -1000] - &#34;/C=AUS/ST=NSW/L=Sydney/O=Default Company Ltd/CN=Max Bergman (maxb)&#34; &#34;POST /accounting/ui/dispatch.rpc HTTP/1.1&#34; 200/200 4627 2389/3796/14 &#34;https://stroomnode01.strmdev01.org/accounting/&#34; &#34;Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.99 Safari/537.36&#34; stroomnode01.strmdev01.org/443
192.168.3.117/62294 - [18/Jan/2020:12:44:04 -1000] - &#34;/C=AUS/ST=NSW/L=Sydney/O=Default Company Ltd/CN=Max Bergman (maxb)&#34; &#34;POST /accounting/ui/dispatch.rpc HTTP/1.1&#34; 200/200 12367 2289/415/14 &#34;https://stroomnode01.strmdev01.org/accounting/&#34; &#34;Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.99 Safari/537.36&#34; stroomnode01.strmdev01.org/443
192.168.3.117/62349 - [18/Jan/2020:12:44:04 -1000] - &#34;/C=AUS/ST=NSW/L=Sydney/O=Default Company Ltd/CN=Max Bergman (maxb)&#34; &#34;POST /accounting/ui/dispatch.rpc HTTP/1.1&#34; 200/200 12765 2289/415/14 &#34;https://stroomnode01.strmdev01.org/accounting/&#34; &#34;Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.99 Safari/537.36&#34; stroomnode01.strmdev01.org/443
192.168.2.245/62429 - [18/Jan/2020:12:50:04 +0200] - &#34;/C=GBR/ST=GLOUCESTERSHIRE/L=Bristol/O=Default Company Ltd/CN=Kostas Kosta (kk)&#34; &#34;POST /accounting/ui/dispatch.rpc HTTP/1.1&#34; 200/200 12245 2289/415/14 &#34;https://stroomnode00.strmdev01.org/accounting/&#34; &#34;Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.99 Safari/537.36&#34; stroomnode00.strmdev01.org/443
192.168.2.245/62495 - [18/Jan/2020:12:51:04 +0200] - &#34;/C=GBR/ST=GLOUCESTERSHIRE/L=Bristol/O=Default Company Ltd/CN=Kostas Kosta (kk)&#34; &#34;POST /accounting/ui/dispatch.rpc HTTP/1.1&#34; 200/200 4327 2289/415/14 &#34;https://stroomnode00.strmdev01.org/accounting/&#34; &#34;Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.99 Safari/537.36&#34; stroomnode00.strmdev01.org/443
192.168.2.245/62549 - [18/Jan/2020:12:52:04 +0200] - &#34;/C=GBR/ST=GLOUCESTERSHIRE/L=Bristol/O=Default Company Ltd/CN=Kostas Kosta (kk)&#34; &#34;POST /accounting/ui/dispatch.rpc HTTP/1.1&#34; 200/200 7148 2289/415/14 &#34;https://stroomnode00.strmdev01.org/accounting/&#34; &#34;Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.99 Safari/537.36&#34; stroomnode00.strmdev01.org/443
192.168.2.245/62626 - [18/Jan/2020:12:52:04 +0200] - &#34;/C=GBR/ST=GLOUCESTERSHIRE/L=Bristol/O=Default Company Ltd/CN=Kostas Kosta (kk)&#34; &#34;POST /accounting/ui/dispatch.rpc HTTP/1.1&#34; 200/200 11386 2289/415/14 &#34;https://stroomnode00.strmdev01.org/accounting/&#34; &#34;Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.99 Safari/537.36&#34; stroomnode00.strmdev01.org/443
</code></pre></div><p>A copy of this sample data source can be found <a href="sampleApacheBlackBox.log" title="Apache BlackBox sample log">here</a>. Save a copy of this data to your local environment for use later in this HOWTO. Save this file as a text document with ANSI encoding.</p>
<h2 id="create-the-feed-and-its-pipeline">Create the Feed and its Pipeline</h2>
<p>To reflect the source of these Accounting Logs, we will name our feed and its pipeline Apache-SSLBlackBox-V2.0-EVENTS and it will be stored in the system group Apache HTTPD under the main system group - <code>Event Sources</code>.</p>
<h3 id="create-system-group">Create System Group</h3>
<p>To create the system group Apache  HTTPD, navigate to the <em>Event Sources/Infrastructure/WebServer</em> system group within the Explorer pane (if this system group structure does not already exist in your Stroom instance then refer to the <strong>HOWTO Stroom Explorer Management</strong> for guidance). Left click to highlight the
<em>WebServer</em> system group then right click to bring up the object context menu. Navigate to the <em>New</em> icon, then the <em>Folder</em> icon to reveal the <em>New Folder</em> selection window.</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-00.png" alt="Stroom UI ApacheHTTPDEventFeed - Navigate Explorer" title="Navigate Explorer"></p>
<p>In the New Folder window enter Apache HTTPD into the <strong>Name:</strong> text entry box.</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-01.png" alt="Stroom UI ApacheHTTPDEventFeed - Create System Group" title="Create System Group"></p>
<p>The click on <strong>OK</strong> at which point you will be presented with the Apache HTTPD system group configuration tab. Also note, the <em>WebServer</em> system group within the Explorer pane has automatically expanded to display the <code>Apache HTTPD</code> system group.</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-02.png" alt="Stroom UI ApacheHTTPDEventFeed - Apache System Group tab" title="Create System Group tab"></p>
<p>Close the Apache HTTPD system group configuration tab by clicking on the close item icon on the right-hand side of the tab <img src="../resources/icons/closeItem.png" alt="close" title="closeItem">. We now need to create, in order</p>
<ul>
<li>the Feed,</li>
<li>the Text Parser,</li>
<li>the Translation and finally,</li>
<li>the Pipeline.</li>
</ul>
<h3 id="create-feed">Create Feed</h3>
<p>Within the Explorer pane, and having selected the Apache HTTPD group, right click to bring up object context menu. Navigate to New, Feed</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-03.png" alt="Stroom UI ApacheHTTPDEventFeed - Apache Create Feed" title="Apache Create Feed"></p>
<p>Select the Feed icon <img src="../resources/icons/feedItem.png" alt="feed" title="feedItem">, when the <strong>New Feed</strong> selection window comes up, ensure the <code>Apache HTTPD</code> system group is selected or navigate to it. Then enter the name of the feed, Apache-SSLBlackBox-V2.0-EVENTS, into the <strong>Name:</strong> text entry box the press <strong>OK</strong>.</p>
<p>It should be noted that the default Stroom FeedName pattern will not accept this name. One needs to modify the <code>stroom.feedNamePattern</code> stroom property to change the default pattern to <code>^[a-zA-Z0-9_-\.]{4,}$</code>. See the <a href="../Administration/SystemProperties.md" title="System Properties">HOWTO on System Properties</a> document to see how to make this change.</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-04.png" alt="Stroom UI ApacheHTTPDEventFeed - New Feed dialog" title="New Feed dialog"></p>
<p>At this point you will be presented with the new feed&rsquo;s configuration tab and the feed&rsquo;s Explorer object will automatically appear in the Explorer pane within the <code>Apache HTTPD</code> system group.</p>
<p>Select the <em>Settings</em> tab on the feed&rsquo;s configuration tab.
Enter an appropriate description into the <strong>Description:</strong> text entry box, for instance:</p>
<p>&ldquo;Apache HTTPD events for BlackBox Version 2.0.  These events are from a Secure service  (https).&rdquo;</p>
<p>In the <strong>Classification:</strong> text entry box, enter a Classification of the data that the event feed will contain - that is the classification or sensitivity of the accounting log’s content itself.</p>
<p>As this is not a Reference Feed, leave the <strong>Reference Feed:</strong> check box unchecked.</p>
<p>We leave the <strong>Feed Status:</strong> at <em>Receive</em>.</p>
<p>We leave the <strong>Stream Type:</strong> as <em>Raw Events</em> as this we will be sending batches (streams) of raw event logs.</p>
<p>We leave the <strong>Data Encoding:</strong> as UTF-8 as the raw logs are in this form.</p>
<p>We leave the <strong>Context Encoding:</strong> as UTF-8 as there no context events for this feed.</p>
<p>We leave the <strong>Retention Period:</strong> at <em>Forever</em> as we do not want to delete the raw logs.</p>
<p>This results in</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-05.png" alt="Stroom UI ApacheHTTPDEventFeed - New Feed tab" title="New Feed tab"></p>
<p>Save the feed by clicking on the <img src="../resources/icons/save.png" alt="save" title="Save"> icon.</p>
<h3 id="create-text-converter">Create Text Converter</h3>
<p>Within the Explorer pane, and having selected the <code>Apache HTTPD</code> system group, right click to bring up object context menu, then navigate to the <img src="../resources/icons/newItemv6.png" alt="new-v6" title="New"> icon to reveal the New sub-context menu. Next, navigate to the <img src="../resources/icons/save.png" alt="textConverterItem" title="Text Converter Item">  Text Converter item</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-06.png" alt="Stroom UI ApacheHTTPDEventFeed - Select Text Converter" title="Select Text Converter"></p>
<p>and left click to select. When the <strong>New Text Converter</strong></p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-07.png" alt="Stroom UI ApacheHTTPDEventFeed - New Text Converter" title="New Text Converter"></p>
<p>selection window comes up enter the name of the feed, Apache-SSLBlackBox-V2.0-EVENTS, into the <strong>Name:</strong> text entry box then press <strong>OK</strong>. At this point you will be presented with the new text converter&rsquo;s configuration tab.</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-08.png" alt="Stroom UI ApacheHTTPDEventFeed - Text Converter configuration tab" title="Text Converter configuration tab"></p>
<p>Enter an appropriate description into the <strong>Description:</strong> text entry box, for instance</p>
<p>&ldquo;Apache HTTPD events for BlackBox Version 2.0 - text converter. See Conversion for complete documentation.&rdquo;</p>
<p>Set the <strong>Converter Type:</strong> to be Data Splitter from drop down menu.</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-09.png" alt="Stroom UI ApacheHTTPDEventFeed - Text Converter settings" title="Text Converter configuration settings"></p>
<p>Save the text converter by clicking on the <img src="../resources/icons/save.png" alt="save" title="Save"> icon.</p>
<h3 id="create-xslt-translation">Create XSLT Translation</h3>
<p>Within the Explorer pane, and having selected the <code>Apache HTTPD</code> system group, right click to bring up object context menu, then navigate to the 	New icon to reveal the New sub-context menu. Next, navigate to the <img src="../resources/icons/xsltItem.png" alt="xsltItem" title="xsltItem"> item and left click to select.</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-10.png" alt="Stroom UI ApacheHTTPDEventFeed - New XSLT" title="New XSLT"></p>
<p>When the <strong>New XSLT</strong> selection window comes up,</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-11.png" alt="Stroom UI ApacheHTTPDEventFeed - New XSLT" title="New XSLT"></p>
<p>enter the name of the feed, Apache-SSLBlackBox-V2.0-EVENTS, into the <strong>Name:</strong> text entry box then press <strong>OK</strong>. At this point you will be presented with the new XSLT&rsquo;s configuration tab.</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-12.png" alt="Stroom UI ApacheHTTPDEventFeed - New XSLT tab" title="New XSLT tab"></p>
<p>Enter an appropriate description into the <strong>Description:</strong> text entry box, for instance</p>
<p>&ldquo;Apache HTTPD events for  BlackBox Version 2.0  - translation. See Translation for complete documentation.&rdquo;</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-13.png" alt="Stroom UI ApacheHTTPDEventFeed - New XSLT settings" title="New XSLT settings"></p>
<p>Save the XSLT by clicking on the <img src="../resources/icons/save.png" alt="save" title="Save"> icon.</p>
<h3 id="create-pipeline">Create Pipeline</h3>
<p>In the process of creating this pipeline we have assumed that the  <strong>Template Pipeline</strong> content pack has been loaded, so that we can <em>Inherit</em> a pipeline structure from this content pack and configure it to support this specific feed.</p>
<p>Within the Explorer pane, and having selected the Apache HTTPD system group, right click to bring up object context menu, then the New sub-context menu. Navigate to the <img src="../resources/icons/pipeline.png" alt="pipeline" title="Pipeline">  Pipeline and left click to select. When the <strong>New Pipeline</strong></p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-14.png" alt="Stroom UI ApacheHTTPDEventFeed - New Pipeline" title="New Pipeline"></p>
<p>selection window comes up, navigate to, then select the Apache HTTPD system group and then enter the name of the pipeline, Apache-SSLBlackBox-V2.0-EVENTS
into the <strong>Name:</strong> text entry box then press <strong>OK</strong>. At this you will be presented with the new pipeline’s configuration tab</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-15.png" alt="Stroom UI ApacheHTTPDEventFeed - New Pipeline tab" title="New Pipeline tab"></p>
<p>As usual, enter an appropriate <strong>Description:</strong></p>
<p>&ldquo;Apache HTTPD events for BlackBox Version 2.0  - pipeline. This pipeline uses the standard event pipeline to store the events in the Event Store.&rdquo;</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-16.png" alt="Stroom UI ApacheHTTPDEventFeed - New Pipeline settings" title="New Pipeline settings"></p>
<p>Save the pipeline by clicking on the <img src="../resources/icons/save.png" alt="save" title="Save"> icon.</p>
<p>We now need to select the structure this pipeline will use. We need to move from the <strong>Settings</strong> sub-item on the pipeline configuration tab to the <strong>Structure</strong> sub-item. This is done by clicking on the <strong>Structure</strong> link, at which we see</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-17.png" alt="Stroom UI ApacheHTTPDEventFeed - New Pipeline Structure" title="New Pipeline Structure"></p>
<p>Next we will choose an Event Data pipeline. This is done by inheriting it from a defined set of Template Pipelines. To do this, click on the menu selection icon  to the right of the Inherit From: text display box.</p>
<p>When the <strong>Choose item</strong></p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-18.png" alt="Stroom UI ApacheHTTPDEventFeed - New Pipeline inherited from" title="New Pipeline inherited from"></p>
<p>selection window appears, select from the <code>Template Pipelines</code> system group. In this instance, as our input data is text, we select (left click) the</p>
<p><img src="../resources/icons/pipeline.png" alt="pipeline" title="Pipeline"> Event Data (Text) pipeline</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-19.png" alt="Stroom UI ApacheHTTPDEventFeed - New Pipeline inherited selection" title="New Pipeline inherited selection"></p>
<p>then press <strong>OK</strong>. At this we see the inherited pipeline structure of</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-20.png" alt="Stroom UI ApacheHTTPDEventFeed - New Pipeline inherited structure" title="New Pipeline inherited structure"></p>
<p>For the purpose of this HOWTO, we are only interested in two of the eleven (11) elements in this pipeline</p>
<ul>
<li>the Text Converter labelled <em>dsParser</em></li>
<li>the XSLT Translation labelled <em>translationFilter</em></li>
</ul>
<p>We now need to associate our Text Converter and Translation with the pipeline so that we can pass raw events (logs) through our pipeline in order to save them in the Event Store.</p>
<p>To associate the Text Converter, select the Text Converter icon, to display.</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-21.png" alt="Stroom UI ApacheHTTPDEventFeed - New Pipeline associate textconverter" title="New Pipeline associate textconverter"></p>
<p>Now identify to the <strong>Property</strong> pane (the middle pane of the pipeline configuration tab), then and double click on the <em>textConverter</em> Property Name to display the <strong>Edit
Property</strong> selection window that allows you to edit the given property</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-22.png" alt="Stroom UI ApacheHTTPDEventFeed - New Pipeline textconverter association" title="New Pipeline textconverter association"></p>
<p>We leave the Property <strong>Source:</strong> as Inherit but we need to change the Property <strong>Value:</strong> from <em>None</em> to be our newly created Apache-SSLBlackBox-V2.0-EVENTS Text Converter.</p>
<p>To do this, position the cursor over the menu selection <img src="../resources/icons/menu-selection-horizontal.png" alt="menu" title="Menu"> icon to the right of the <strong>Value:</strong> text display box and click to select. Navigate to the <code>Apache HTTPD</code> system group then select the Apache-SSLBlackBox-V2.0-EVENTS text Converter</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-23.png" alt="Stroom UI ApacheHTTPDEventFeed - New Pipeline textconverter association" title="New Pipeline textconverter association"></p>
<p>then press <strong>OK</strong>. At this we will see the Property <em>Value</em> set</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-24.png" alt="Stroom UI ApacheHTTPDEventFeed - New Pipeline textconverter association" title="New Pipeline textconverter association"></p>
<p>Again press <em>OK</em> to finish editing this property and we see that the <em>textConverter</em> Property has been set to <strong>Apache-SSLBlackBox-V2.0-EVENTS</strong></p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-25.png" alt="Stroom UI ApacheHTTPDEventFeed - New Pipeline textconverter association" title="New Pipeline textconverter association"></p>
<p>We perform the same actions to associate the translation.</p>
<p>First, we select the translation Filter’s <img src="../resources/icons/translationFilter.png" alt="translationFilter" title="Translation Filter"> icon and then within translation Filter’s <strong>Property</strong> pane we double click on the <em>xslt</em> Property Name to bring up the <strong>Property Editor</strong>. As before, bring up the <strong>Choose item</strong> selection window, navigate to the <code>Apache HTTPD</code> system group and select the
Apache-SSLBlackBox-V2.0-EVENTS xslt Translation.</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-26.png" alt="Stroom UI ApacheHTTPDEventFeed - New Pipeline Translation association" title="New Pipeline Translation association"></p>
<p>We leave the remaining properties in the translation Filter’s <strong>Property</strong> pane at their default values. The result is the assignment of our translation to the <em>xslt</em> Property.</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-27.png" alt="Stroom UI ApacheHTTPDEventFeed - New Pipeline Translation association" title="New Pipeline Translation association"></p>
<p>For the moment, we will not associate a decoration filter.</p>
<p>Save the pipeline by clicking on its <img src="../resources/icons/save.png" alt="save" title="Save"> icon.</p>
<h3 id="manually-load-raw-event-test-data">Manually load Raw Event test data</h3>
<p>Having established the pipeline, we can now start authoring our text converter and translation. The first step is to load some Raw Event test data. Previously in the <strong>Event Log Source</strong> of this HOWTO you saved a copy of the file <em>sampleApacheBlackBox.log</em> to your local environment. It contains only a few events as the content is consistently formatted. We could feed the test data by posting the file to Stroom’s accounting/datafeed url, but for this example we will manually load the file. Once developed, raw data is posted to the web service.</p>
<p>Select the <img src="../resources/v6/UI-ApacheHttpEventFeed-28.png" alt="Stroom UI ApacheHTTPDEventFeed - ApacheHHTPDFeed" title="ApacheHHTPDFeed"> configuration tab and select the <strong>Data</strong> sub-item to display</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-29.png" alt="Stroom UI ApacheHTTPDEventFeed - Data Loading" title="Data Loading"></p>
<p>This window is divided into three panes.</p>
<p>The top pane displays the <em>Stream Table</em>, which is a table of the latest streams that belong to the feed (clearly it’s empty).</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-30.png" alt="Stroom UI ApacheHTTPDEventFeed - Data Loading - Stream Table" title="Data Loading - Stream Table"></p>
<p>Note that a Raw Event <em>stream</em> is made up of data from a single file of data or aggregation of multiple data files and also meta-data associated with the data file(s). For example, file names, file size, etc.</p>
<p>The middle pane displays a <em>Specific</em> feed and any linked streams. To display a <em>Specific</em> feed, you select it from the <em>Stream Table</em> above.</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-31.png" alt="Stroom UI ApacheHTTPDEventFeed - Data Loading - Specific Stream" title="Data Loading - Specific Stream"></p>
<p>The bottom pane displays the selected stream’s data or meta-data.</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-32.png" alt="Stroom UI ApacheHTTPDEventFeed - Data Loading - Data/Metadata" title="Data Loading - Data/Metadata"></p>
<p>Note the Upload icon <img src="../resources/icons/upload.png" alt="upload" title="Upload"> in the top left of the Stream table pane. On clicking the Upload icon, we are presented with the data <strong>Upload</strong> selection window.</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-33.png" alt="Stroom UI ApacheHTTPDEventFeed - Data Loading - Upload Data" title="Data Loading - Upload Data"></p>
<p>As stated earlier, raw event data is normally posted as a file to the Stroom web server. As part of this posting action, a set of well-defined HTTP <em>extra headers</em> are sent as part of the post. These headers, in the form of key value pairs, provide additional context associated with the system sending the logs. These standard headers become Stroom <em>feed attributes</em> available to the Stroom translation. Common attributes are</p>
<ul>
<li>System - the name of the System providing the logs</li>
<li>Environment - the environment of the system (Production, Quality Assurance, Reference, Development)</li>
<li>Feed - the feedname itself</li>
<li>MyHost - the fully qualified domain name of the system sending the logs</li>
<li>MyIPaddress - the IP address of the system sending the logs</li>
<li>MyNameServer - the name server the system resolves names through</li>
</ul>
<p>Since our translation will want these feed attributes, we will set them in the Meta Data text entry box of the <strong>Upload</strong> selection window. Note we can skip <em>Feed</em> as this will automatically be assigned correctly as part of the upload action (setting it to Apache-SSLBlackBox-V2.0-EVENTS obviously). Our <strong>Meta Data:</strong> will have</p>
<ul>
<li>System:LinuxWebServer</li>
<li>Environment:Production</li>
<li>MyHost:stroomnode00.strmdev01.org</li>
<li>MyIPaddress:192.168.2.245</li>
<li>MyNameServer:192.168.2.254</li>
</ul>
<p>We select a <strong>Stream Type:</strong> of <em>Raw Events</em> as this data is for an <em>Event Feed</em>. As this is not a <em>Reference Feed</em> we ignore the <strong>Effective:</strong> entry box (a date/time selector).</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-34.png" alt="Stroom UI ApacheHTTPDEventFeed - Upload Data" title="Upload Data"></p>
<p>We now click the <strong>Choose File</strong> button, then navigate to the location of the raw log file you downloaded earlier, <em>sampleApacheBlackBox.log</em></p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-35.png" alt="Stroom UI ApacheHTTPDEventFeed - Upload Data" title="Upload Data"></p>
<p>then click <strong>Open</strong> to return to the <strong>Upload</strong> selection window where we can then press <strong>OK</strong> to perform the upload.</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-36.png" alt="Stroom UI ApacheHTTPDEventFeed - Upload Data" title="Upload Data"></p>
<p>An Alert dialog window is presented <img src="../resources/v6/UI-ApacheHttpEventFeed-37.png" alt="Stroom UI ApacheHTTPDEventFeed - Alert" title="Alert">  which should be <strong>closed</strong>.</p>
<p>The stream we have just loaded will now be displayed in the  <em>Streams Table</em> pane. Note that the <em>Specific Stream</em>
and <em>Data/Meta-data</em> panes are still blank.</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-38.png" alt="Stroom UI ApacheHTTPDEventFeed - Data Loading - Streams Table" title="Data Loading - Streams Table"></p>
<p>If we select the stream by clicking anywhere along its line, the stream is highlighted and the <em>Specific Stream</em> and Data/Meta-data_ panes now display data.</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-39.png" alt="Stroom UI ApacheHTTPDEventFeed - Data Loading - Streams Table" title="Data Loading - Streams Table"></p>
<p>The <em>Specific Stream</em> pane only displays the Raw Event stream and the <em>Data/Meta-data</em> pane displays the content of the log file just uploaded (the <strong>Data</strong> link). If we were to click on the <strong>Meta</strong> link at the top of the <em>Data/Meta-data</em> pane, the log data is replaced by this stream’s meta-data.</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-40.png" alt="Stroom UI ApacheHTTPDEventFeed - Data Loading - Meta-data" title="Data Loading - Meta-data"></p>
<p>Note that, in addition to the feed attributes we set, the upload process added additional feed attributes of</p>
<ul>
<li>Feed - the feed name</li>
<li>ReceivedTime - the time the feed was received by Stroom</li>
<li>RemoteFile - the name of the file loaded</li>
<li>StreamSize - the size, in bytes, of the loaded data within the stream</li>
<li>user-agent - the user agent used to present the stream to Stroom - in this case, the Stroom user Interface</li>
</ul>
<p>We now have data that will allow us to develop our text converter and translation.</p>
<h3 id="step-data-through-pipeline---source">Step data through Pipeline - Source</h3>
<p>We now need to step our data through the pipeline.</p>
<p>To do this, set the check-box on the <em>Specific Stream</em> pane and we note that the previously grayed out action icons <img src="../resources/v6/UI-ApacheHttpEventFeed-41.png" alt="Stroom UI ApacheHTTPDEventFeed - SpecificStreamActionIcons" title="Specific Stream Action Icons"> are activated <img src="../resources/v6/UI-ApacheHttpEventFeed-42.png" alt="Stroom UI ApacheHTTPDEventFeed - SpecificStreamActionIconsActivated" title="Specific Stream Action Icons activated"></p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-43.png" alt="Stroom UI ApacheHTTPDEventFeed - Select Stream to Step" title="Select Stream to Step"></p>
<p>We now want to step our data through the first element of the pipeline, the Text Converter. We enter Stepping Mode by pressing the stepping button <img src="../resources/icons/enterStepping.png" alt="enterStep" title="Enter Stepping Mode"> found at the bottom right corner of the <em>Data/Meta-data</em> pane.</p>
<p>We will then be requested to choose a pipeline to step with, at which, you should navigate to the Apache-SSLBlackBox-V2.0-EVENTS pipeline as per</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-44.png" alt="Stroom UI ApacheHTTPDEventFeed - Select pipeline to Step" title="Select pipeline to Step"></p>
<p>then press <strong>OK</strong>.</p>
<p>At this point, we enter the pipeline Stepping tab</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-45.png" alt="Stroom UI ApacheHTTPDEventFeed - pipeline Stepping tab - Source" title="pipeline Stepping tab - Source"></p>
<p>which, initially displays the Raw Event data from our stream. This is the Source display for the Event Pipeline.</p>
<h3 id="step-data-through-pipeline---text-converter">Step data through Pipeline - Text Converter</h3>
<p>We click on the <img src="../resources/icons/dsParserv6.png" alt="dsParserv6" title="dsParser"> icon to enter the Text Converter stepping window.</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-46.png" alt="Stroom UI ApacheHTTPDEventFeed - pipeline Stepping tab - Text Converter" title="pipeline Stepping tab - Text Converter"></p>
<p>This <em>stepping</em> tab is divided into three sub-panes. The top one is the Text Converter editor and it will allow you to edit the text conversion. The bottom left window displays the <em>input</em> to the Text Converter. The bottom right window displays the <em>output</em> from the Text Converter for the given input.</p>
<p>We also note an error indicator - that of an error in the editor pane as indicated by the black back-grounded x and rectangular black boxes to the right of the editor’s scroll bar.</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-47.png" alt="Stroom UI ApacheHTTPDEventFeed - pipeline Stepping tab - Error" title="pipeline Stepping tab - Error"></p>
<p>In essence, this means that we have no text converter to pass the Raw Event data through.</p>
<p>To correct this, we will author our text converter using the Data Splitter <em>language</em>. Normally this is done incrementally to more easily develop the parser. The minimum text converter contains</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#099">&lt;?xml version=&#34;1.1&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span style="color:#309;font-weight:bold">&lt;dataSplitter</span> <span style="color:#309">xmlns=</span><span style="color:#c30">&#34;data-splitter:3&#34;</span> <span style="color:#309">xmlns:xsi=</span><span style="color:#c30">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span style="color:#309">xsi:schemaLocation=</span><span style="color:#c30">&#34;data-splitter:3 file://data-splitter-v3.0.1.xsd&#34;</span> <span style="color:#309">version=</span><span style="color:#c30">&#34;3.0&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;split</span>  <span style="color:#309">delimiter=</span><span style="color:#c30">&#34;\n&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;group&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;regex</span> <span style="color:#309">pattern=</span><span style="color:#c30">&#34;^(.*)$&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;rest&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;$1&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;/regex&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;/group&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;/split&gt;</span>
<span style="color:#309;font-weight:bold">&lt;/dataSplitter&gt;</span>
</code></pre></div><p>If we now press the Step First <img src="../resources/icons/stepFirst.png" alt="stepFirst" title="Step first"> icon the error will disappear and the stepping window will show.</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-48.png" alt="Stroom UI ApacheHTTPDEventFeed - pipeline Stepping tab - Text Converter Simple A" title="pipeline Stepping tab - Text Converter Simple A"></p>
<p>As we can see, the first line of our Raw Event is displayed in the <em>input</em> pane and the <em>output</em> window holds the converted XML output where we just have a single <em>data</em> element with a <em>name</em> attribute of <em>rest</em> and a <em>value</em> attribute of the complete raw event as our regular expression matched the entire line.</p>
<p>The next incremental step in the parser, would be to <em>parse out</em> additional <em>data</em> elements. For example, in this next iteration we extract the client ip address, the client port and hold the rest of the Event in the rest data element.</p>
<p>With the text converter containing</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#099">&lt;?xml version=&#34;1.1&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span style="color:#309;font-weight:bold">&lt;dataSplitter</span> <span style="color:#309">xmlns=</span><span style="color:#c30">&#34;data-splitter:3&#34;</span> <span style="color:#309">xmlns:xsi=</span><span style="color:#c30">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span style="color:#309">xsi:schemaLocation=</span><span style="color:#c30">&#34;data-splitter:3 file://data-splitter-v3.0.1.xsd&#34;</span> <span style="color:#309">version=</span><span style="color:#c30">&#34;3.0&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;split</span>  <span style="color:#309">delimiter=</span><span style="color:#c30">&#34;\n&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;group&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;regex</span> <span style="color:#309">pattern=</span><span style="color:#c30">&#34;^([^/]+)/([^  ]+) (.*)$&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;clientip&#34;</span>  <span style="color:#309">value=</span><span style="color:#c30">&#34;$1&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;clientport&#34;</span>  <span style="color:#309">value=</span><span style="color:#c30">&#34;$2&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;rest&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;$3&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;/regex&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;/group&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;/split&gt;</span>
<span style="color:#309;font-weight:bold">&lt;/dataSplitter&gt;</span>
</code></pre></div><p>and a click on the Refresh Current Step <img src="../resources/icons/stepRefresh.png" alt="stepRefresh" title="Step Refresh"> icon we will see the <em>output</em> pane contain</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-49.png" alt="Stroom UI ApacheHTTPDEventFeed - pipeline Stepping tab - Text Converter Simple B" title="Text Converter Simple B"></p>
<p>We continue this incremental parsing until we have our complete parser.</p>
<p>The following is our complete Text Converter which generates xml records as defined by the Stroom <strong>records v3.0</strong> schema.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#099">&lt;?xml version=&#34;1.1&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span style="color:#309;font-weight:bold">&lt;dataSplitter</span> <span style="color:#309">xmlns=</span><span style="color:#c30">&#34;data-splitter:3&#34;</span> <span style="color:#309">xmlns:xsi=</span><span style="color:#c30">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span style="color:#309">xsi:schemaLocation=</span><span style="color:#c30">&#34;data-splitter:3 file://data-splitter-v3.0.1.xsd&#34;</span> <span style="color:#309">version=</span><span style="color:#c30">&#34;3.0&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>

<span style="color:#09f;font-style:italic">&lt;!-- CLASSIFICATION: UNCLASSIFIED --&gt;</span>

<span style="color:#09f;font-style:italic">&lt;!-- Release History:
</span><span style="color:#09f;font-style:italic">Release 20131001, 1 Oct 2013 - Initial release 
</span><span style="color:#09f;font-style:italic">
</span><span style="color:#09f;font-style:italic">General Notes: 
</span><span style="color:#09f;font-style:italic">This data splitter takes audit events for the Stroom variant of the Black Box Apache Auditing.
</span><span style="color:#09f;font-style:italic">
</span><span style="color:#09f;font-style:italic">Event Format: The following is extracted from the Configuration settings for the Stroom variant of the Black Box Apache Auditing format.
</span><span style="color:#09f;font-style:italic">
</span><span style="color:#09f;font-style:italic">#  STROOM - Black  Box  Auditing configuration
</span><span style="color:#09f;font-style:italic">#
</span><span style="color:#09f;font-style:italic">#  %a  - Client  IP address  (not  hostname (%h) to ensure ip address only)
</span><span style="color:#09f;font-style:italic">#  When  logging the remote host,  it is important to log the client  IP address, not the
</span><span style="color:#09f;font-style:italic">#  hostname. We do   this  with the &#39;%a&#39; directive.  Even  if HostnameLookups  are turned on,
</span><span style="color:#09f;font-style:italic">#  using &#39;%a&#39; will  only record the IP address.  For the purposes of BlackBox formats,
</span><span style="color:#09f;font-style:italic">#  reversed DNS should not  be trusted
</span><span style="color:#09f;font-style:italic">
</span><span style="color:#09f;font-style:italic">#  %{REMOTE_PORT}e  - Client source port
</span><span style="color:#09f;font-style:italic">#  Logging the client  source TCP  port  can provide some   useful  network data and can help
</span><span style="color:#09f;font-style:italic">#  one associate a single client  with multiple requests.
</span><span style="color:#09f;font-style:italic">#  If two   clients from the  same IP address  make   simultaneous connections, the &#39;common  log&#39;
</span><span style="color:#09f;font-style:italic">#  file format cannot distinguish  between those  clients. Otherwise, if  the client uses
</span><span style="color:#09f;font-style:italic">#  keep-alives, then every hit  made   from a single  TCP  session will  be associated  by   the  same
</span><span style="color:#09f;font-style:italic">#  client  port number.
</span><span style="color:#09f;font-style:italic">#  The   port information can indicate  how  many   connections our server is  handling at  once,
</span><span style="color:#09f;font-style:italic">#  which may  help in tuning server TCP/OP   settings. It will also identify which client ports
</span><span style="color:#09f;font-style:italic">#  are legitimate requests if  the administrator is examining a possible  SYN-attack against  a
</span><span style="color:#09f;font-style:italic">#  server.
</span><span style="color:#09f;font-style:italic">#  Note we  are using the REMOTE_PORT  environment variable. Environment variables  only come
</span><span style="color:#09f;font-style:italic">#  into play when   mod_cgi or  mod_cgid is  handling the request.
</span><span style="color:#09f;font-style:italic">
</span><span style="color:#09f;font-style:italic">#  %X   - Connection status  (use %c  for  Apache 1.3)
</span><span style="color:#09f;font-style:italic">#  The   connection status  directive  tells us detailed  information about the client  connection.
</span><span style="color:#09f;font-style:italic">#  It returns  one of three flags:
</span><span style="color:#09f;font-style:italic">#  x  if the client aborted the connection before completion,
</span><span style="color:#09f;font-style:italic">#  +  if  the client has indicated that it will  use keep-alives (and request additional  URLS),
</span><span style="color:#09f;font-style:italic">#  - if the connection will  be closed after  the event
</span><span style="color:#09f;font-style:italic">#  Keep-Alive is a HTTP 1.1.  directive  that  informs a web  server that  a client  can request multiple
</span><span style="color:#09f;font-style:italic">#  files during the  same connection.  This way  a client  doesn&#39;t need to go   through the  overhead
</span><span style="color:#09f;font-style:italic">#  of re-establishing  a TCP  connection to retrieve  a new  file.
</span><span style="color:#09f;font-style:italic">
</span><span style="color:#09f;font-style:italic">#  %t  - time - or  [%{%d/%b/%Y:%T}t.%{msec_frac}t %{%z}t] for  Apache 2.4
</span><span style="color:#09f;font-style:italic">#  The   %t  directive  records the time that  the request started.
</span><span style="color:#09f;font-style:italic">#  NOTE:  When  deployed on   an  Apache 2.4, or better,  environment, you   should use
</span><span style="color:#09f;font-style:italic">#  strftime  format in  order  to  get  microsecond resolution.
</span><span style="color:#09f;font-style:italic">
</span><span style="color:#09f;font-style:italic">#  %l  - remote logname
</span><span style="color:#09f;font-style:italic">#
</span><span style="color:#09f;font-style:italic">
</span><span style="color:#09f;font-style:italic">#  %u - username [in quotes]
</span><span style="color:#09f;font-style:italic">#  The   remote user  (from auth;  This may  be bogus if the return status  (%s) is  401
</span><span style="color:#09f;font-style:italic">#  for non-ssl services)
</span><span style="color:#09f;font-style:italic">#  For SSL  services,  user names need to  be delivered  as DNs  to deliver PKI   user details
</span><span style="color:#09f;font-style:italic">#  in full.  To  pass through PKI   certificate  properties in the correct form you   need to
</span><span style="color:#09f;font-style:italic">#  add the following directives  to your  Apache configuration:
</span><span style="color:#09f;font-style:italic">#  SSLUserName   SSL_CLIENT_S_DN
</span><span style="color:#09f;font-style:italic">#  SSLOptions +StdEnvVars
</span><span style="color:#09f;font-style:italic">#  If you   cannot,  then use %{SSL_CLIENT_S_DN}x   in place of %u and use  blackboxSSLUser
</span><span style="color:#09f;font-style:italic">#  LogFormat nickname
</span><span style="color:#09f;font-style:italic">
</span><span style="color:#09f;font-style:italic">#  %r  - first  line of text sent by   web  client [in quotes]
</span><span style="color:#09f;font-style:italic">#  This is the first  line of text send by   the web  client, which includes the request
</span><span style="color:#09f;font-style:italic">#  method, the  full URL,  and the  HTTP protocol.
</span><span style="color:#09f;font-style:italic">
</span><span style="color:#09f;font-style:italic">#  %s  - status  code before any redirection
</span><span style="color:#09f;font-style:italic">#  This is  the status  code of the original request.
</span><span style="color:#09f;font-style:italic">
</span><span style="color:#09f;font-style:italic">#  %&gt;s  - status  code after  any redirection  has taken place
</span><span style="color:#09f;font-style:italic">#  This is  the final  status  code of the request, after  any internal  redirections  may
</span><span style="color:#09f;font-style:italic">#  have taken  place.
</span><span style="color:#09f;font-style:italic">
</span><span style="color:#09f;font-style:italic">#  %D   - time in  microseconds to handle the request
</span><span style="color:#09f;font-style:italic">#  This is the  number of microseconds the  server  took to  handle the  request  in  microseconds
</span><span style="color:#09f;font-style:italic">
</span><span style="color:#09f;font-style:italic">#  %I  - incoming bytes
</span><span style="color:#09f;font-style:italic">#  This is  the bytes received, include request and headers. It  cannot, by   definition be zero.
</span><span style="color:#09f;font-style:italic">
</span><span style="color:#09f;font-style:italic">#  %O   - outgoing bytes
</span><span style="color:#09f;font-style:italic">#  This is  the size in bytes of the outgoing data,  including HTTP headers. It  cannot,  by
</span><span style="color:#09f;font-style:italic">#  definition be zero.
</span><span style="color:#09f;font-style:italic">
</span><span style="color:#09f;font-style:italic">#  %B  - outgoing content bytes
</span><span style="color:#09f;font-style:italic">#  This is  the size in bytes of the outgoing data,  EXCLUDING  HTTP headers.  Unlike %b,   which
</span><span style="color:#09f;font-style:italic">#  records &#39;-&#39; for zero bytes transferred,  %B  will record &#39;0&#39;.
</span><span style="color:#09f;font-style:italic">
</span><span style="color:#09f;font-style:italic">#  %{Referer}i - Referrer HTTP Request  Header [in quotes]
</span><span style="color:#09f;font-style:italic">#  This is  typically the URL of the page that  made   the request.  If  linked from
</span><span style="color:#09f;font-style:italic">#  e-mail or direct  entry this  value will be empty. Note, this  can be spoofed
</span><span style="color:#09f;font-style:italic">#  or turned off
</span><span style="color:#09f;font-style:italic">
</span><span style="color:#09f;font-style:italic">#  %{User-Agent}i - User agent HTTP Request  Header [in quotes]
</span><span style="color:#09f;font-style:italic">#  This is  the identifying information the client  (browser) reports about itself.
</span><span style="color:#09f;font-style:italic">#  It can be spoofed or  turned  off
</span><span style="color:#09f;font-style:italic"> 
</span><span style="color:#09f;font-style:italic">#  %V   - the server name   according to the UseCannonicalName setting
</span><span style="color:#09f;font-style:italic">#  This identifies  the virtual  host in a multi host webservice
</span><span style="color:#09f;font-style:italic">
</span><span style="color:#09f;font-style:italic">#  %p - the canonical port of the server servicing the request
</span><span style="color:#09f;font-style:italic">
</span><span style="color:#09f;font-style:italic">#  Define a variation  of the Black Box  logs
</span><span style="color:#09f;font-style:italic">#
</span><span style="color:#09f;font-style:italic">#  Note, you   only need to  use the  &#39;blackboxSSLUser&#39; nickname if you cannot set  the
</span><span style="color:#09f;font-style:italic">#  following directives  for any SSL  configurations
</span><span style="color:#09f;font-style:italic">#  SSLUserName   SSL_CLIENT_S_DN
</span><span style="color:#09f;font-style:italic">#  SSLOptions +StdEnvVars
</span><span style="color:#09f;font-style:italic">#  You  will also note the variation for no   logio  module. The   logio  module supports
</span><span style="color:#09f;font-style:italic">#  the %I  and %O   formatting directive
</span><span style="color:#09f;font-style:italic">#
</span><span style="color:#09f;font-style:italic">&lt;IfModule mod_logio.c&gt; 
</span><span style="color:#09f;font-style:italic">LogFormat &#34;%a/%{REMOTE_PORT}e %X %t %l \&#34;%u\&#34; \&#34;%r\&#34; %s/%&gt;s %D I/%O/%B \&#34;%{Referer}i\&#34; \&#34;%{User-Agent}i\&#34; %V/%p&#34; blackboxUser 
</span><span style="color:#09f;font-style:italic">LogFormat &#34;%a/%{REMOTE_PORT}e %X %t %l \&#34;%{SSL_CLIENT_S_DN}x\&#34; \&#34;%r\&#34; %s/%&gt;s %D %I/%O/%B \&#34;%{Referer}i\&#34; \&#34;%{User-Agent}i\&#34; %V/%p&#34; blackboxSSLUser 
</span><span style="color:#09f;font-style:italic">&lt;/IfModule&gt; 
</span><span style="color:#09f;font-style:italic">&lt;IfModule !mod_logio.c&gt; 
</span><span style="color:#09f;font-style:italic">LogFormat &#34;%a/%{REMOTE_PORT}e %X %t %l \&#34;%u\&#34; \&#34;%r\&#34; %s/%&gt;s %D 0/0/%B \&#34;%{Referer}i\&#34; \&#34;%{User-Agent}i\&#34; %V/$p&#34; blackboxUser 
</span><span style="color:#09f;font-style:italic">LogFormat &#34;%a/%{REMOTE_PORT}e %X %t %l \&#34;%{SSL_CLIENT_S_DN}x\&#34; \&#34;%r\&#34; %s/%&gt;s %D 0/0/%B \&#34;%{Referer}i\&#34; \&#34;%{User-Agent}i\&#34; %V/$p&#34; blackboxSSLUser 
</span><span style="color:#09f;font-style:italic">&lt;/IfModule&gt; --&gt;</span>

<span style="color:#09f;font-style:italic">&lt;!--  Match line --&gt;</span>
<span style="color:#309;font-weight:bold">&lt;split</span>  <span style="color:#309">delimiter=</span><span style="color:#c30">&#34;\n&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;group&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;regex</span> <span style="color:#309">pattern=</span><span style="color:#c30">&#34;^([^/]+)/([^ ]+) ([^ ]+) \[([^\]]+)] ([^ ]+) &amp;#34;([^&amp;#34;]+)&amp;#34; &amp;#34;([^&amp;#34;]+)&amp;#34; (\d+)/(\d+) (\d+) ([^/]+)/([^/]+)/(\d+) &amp;#34;([^&amp;#34;]+)&amp;#34; &amp;#34;([^&amp;#34;]+)&amp;#34; ([^/]+)/([^ ]+)&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;clientip&#34;</span>  <span style="color:#309">value=</span><span style="color:#c30">&#34;$1&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;clientport&#34;</span>  <span style="color:#309">value=</span><span style="color:#c30">&#34;$2&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;constatus&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;$3&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;data</span>  <span style="color:#309">name=</span><span style="color:#c30">&#34;time&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;$4&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;data</span>  <span style="color:#309">name=</span><span style="color:#c30">&#34;remotelname&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;$5&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;data</span>  <span style="color:#309">name=</span><span style="color:#c30">&#34;user&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;$6&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;data</span>  <span style="color:#309">name=</span><span style="color:#c30">&#34;url&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;$7&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;group</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;$7&#34;</span> <span style="color:#309">ignoreErrors=</span><span style="color:#c30">&#34;true&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
                <span style="color:#09f;font-style:italic">&lt;!-- 
</span><span style="color:#09f;font-style:italic">                Special case the &#34;GET  /&#34; url string as opposed to  the  more standard  &#34;method url protocol/protocol_version&#34;.
</span><span style="color:#09f;font-style:italic">                Also special  case a url  of &#34;-&#34;  which occurs  on   some   errors  (eg 408)
</span><span style="color:#09f;font-style:italic">                --&gt;</span>
                    <span style="color:#309;font-weight:bold">&lt;regex</span> <span style="color:#309">pattern=</span><span style="color:#c30">&#34;^-$&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
                        <span style="color:#309;font-weight:bold">&lt;data</span>  <span style="color:#309">name=</span><span style="color:#c30">&#34;url&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;error&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
                    <span style="color:#309;font-weight:bold">&lt;/regex&gt;</span>
                    <span style="color:#309;font-weight:bold">&lt;regex</span> <span style="color:#309">pattern=</span><span style="color:#c30">&#34;^([^ ]+) (/)$&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
                        <span style="color:#309;font-weight:bold">&lt;data</span>  <span style="color:#309">name=</span><span style="color:#c30">&#34;httpMethod&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;$1&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
                        <span style="color:#309;font-weight:bold">&lt;data</span>  <span style="color:#309">name=</span><span style="color:#c30">&#34;url&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;$2&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
                    <span style="color:#309;font-weight:bold">&lt;/regex&gt;</span>
                    <span style="color:#309;font-weight:bold">&lt;regex</span> <span style="color:#309">pattern=</span><span style="color:#c30">&#34;^([^ ]+) ([^  ]+) ([^ /]*)/([^  ]*)&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
                        <span style="color:#309;font-weight:bold">&lt;data</span>  <span style="color:#309">name=</span><span style="color:#c30">&#34;httpMethod&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;$1&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
                        <span style="color:#309;font-weight:bold">&lt;data</span>  <span style="color:#309">name=</span><span style="color:#c30">&#34;url&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;$2&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
                        <span style="color:#309;font-weight:bold">&lt;data</span>  <span style="color:#309">name=</span><span style="color:#c30">&#34;protocol&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;$3&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
                        <span style="color:#309;font-weight:bold">&lt;data</span>  <span style="color:#309">name=</span><span style="color:#c30">&#34;version&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;$4&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
                    <span style="color:#309;font-weight:bold">&lt;/regex&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;/group&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;/data&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;data</span>  <span style="color:#309">name=</span><span style="color:#c30">&#34;responseB&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;$8&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;data</span>  <span style="color:#309">name=</span><span style="color:#c30">&#34;response&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;$9&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;data</span>  <span style="color:#309">name=</span><span style="color:#c30">&#34;timeM&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;$10&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;data</span>  <span style="color:#309">name=</span><span style="color:#c30">&#34;bytesIn&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;$11&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;data</span>  <span style="color:#309">name=</span><span style="color:#c30">&#34;bytesOut&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;$12&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;data</span>  <span style="color:#309">name=</span><span style="color:#c30">&#34;bytesOutContent&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;$13&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;referer&#34;</span>  <span style="color:#309">value=</span><span style="color:#c30">&#34;$14&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;data</span>  <span style="color:#309">name=</span><span style="color:#c30">&#34;userAgent&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;$15&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;data</span>  <span style="color:#309">name=</span><span style="color:#c30">&#34;vserver&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;$16&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;vserverport&#34;</span>  <span style="color:#309">value=</span><span style="color:#c30">&#34;$17&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;/regex&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;/group&gt;</span>
<span style="color:#309;font-weight:bold">&lt;/split&gt;</span>
<span style="color:#309;font-weight:bold">&lt;/dataSplitter&gt;</span>
</code></pre></div><p>A copy of this Data Splitter can be found <a href="ApacheHTTPDBlackBox-DataSplitter.txt" title="ApacheHTTPD BlackBox - Data Splitter">here</a>.</p>
<p>If we now press the Step First <img src="../resources/icons/stepFirst.png" alt="stepFirst" title="Step first"> icon we will see the complete parsed record</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-50.png" alt="Stroom UI ApacheHTTPDEventFeed - pipeline Stepping tab - Text Converter Complete" title="pipeline Stepping tab - Text Converter Complete"></p>
<p>If we click on the Step Forward <img src="../resources/icons/stepForward.png" alt="stepForward" title="Step Forward"> icon we will see the next event displayed in both the <em>input</em> and <em>output</em> panes.</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-51.png" alt="Stroom UI ApacheHTTPDEventFeed - pipeline Stepping tab - Text Converter Complete second event" title="pipeline Stepping tab - Text Converter Complete second event"></p>
<p>we click on the Step Last <img src="../resources/icons/stepLast.png" alt="stepLast" title="Step Last"> icon we will see the last event displayed in both the <em>input</em> and <em>output</em> panes.</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-52.png" alt="Stroom UI ApacheHTTPDEventFeed - pipeline Stepping tab - Text Converter Complete last event" title="pipeline Stepping tab - Text Converter Complete last event"></p>
<p>You should take note of the stepping key that has been displayed in each stepping window. The stepping key are the numbers enclosed in square brackets e.g. [146271:1:14] found in the top right-hand side of the stepping window next to the stepping icons</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-53.png" alt="Stroom UI ApacheHTTPDEventFeed - pipeline Stepping tab - Stepping Key" title="pipeline Stepping tab - Stepping Key"></p>
<p>The form of these keys is [ streamId &lsquo;:&rsquo; subStreamId &lsquo;:&rsquo; recordNo]</p>
<p>where</p>
<ul>
<li><strong>streamId</strong> - is the stream ID and won’t change when stepping through the selected stream.</li>
<li><strong>subStreamId</strong> - is the sub stream ID. When Stroom processes event streams it aggregates multiple input files and this is the file number.</li>
<li><strong>recordNo</strong> - is the record number within the sub stream.</li>
</ul>
<p>One can double click on either the <strong>subStreamId</strong> or <strong>recordNo</strong> numbers and enter a new number. This allows you to ‘step’ around a stream rather than just relying on first, previous, next and last movement.</p>
<p>Note, you should now Save <img src="../resources/icons/save.png" alt="save" title="Save"> your edited Text Converter.</p>
<h3 id="step-data-through-pipeline---translation">Step data through Pipeline - Translation</h3>
<p>To start authoring the xslt Translation Filter, press the <img src="../resources/icons/translationFilter.png" alt="translationFilter" title="Translation Filter">  icon which steps us to the xsl Translation Filter pane.</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-54.png" alt="Stroom UI ApacheHTTPDEventFeed - pipeline Stepping tab - Translation Initial" title="pipeline Stepping tab - Translation Initial"></p>
<p>As for the <em>Text Converter</em> stepping tab, this tab is divided into three sub-panes. The top one is the xslt translation editor and it will allow you to edit the xslt translation. The bottom left window displays the <em>input</em> to the xslt translation (which is the output from the <em>Text Converter</em>). The bottom right window displays the <em>output</em> from the xslt Translation filter for the given input.</p>
<p>We now click on the pipeline Step Forward button <img src="../resources/icons/stepForward.png" alt="stepForward" title="Step Forward"> to single step the Text Converter <em>records</em> element data through our xslt Translation. We see no change as an empty translation will just perform a copy of the input data.</p>
<p>To correct this, we will author our xslt translation. Like the Data Splitter this is also authored incrementally. A minimum xslt translation might contain</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#099">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span style="color:#309;font-weight:bold">&lt;xsl:stylesheet</span> <span style="color:#309">xpath-default-namespace=</span><span style="color:#c30">&#34;records:2&#34;</span> <span style="color:#309">xmlns=</span><span style="color:#c30">&#34;event-logging:3&#34;</span> <span style="color:#309">xmlns:stroom=</span><span style="color:#c30">&#34;stroom&#34;</span> <span style="color:#309">xmlns:xsl=</span><span style="color:#c30">&#34;http://www.w3.org/1999/XSL/Transform&#34;</span> <span style="color:#309">xmlns:xsi=</span><span style="color:#c30">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span style="color:#309">xmlns:xs=</span><span style="color:#c30">&#34;http://www.w3.org/2001/XMLSchema&#34;</span> <span style="color:#309">version=</span><span style="color:#c30">&#34;3.0&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>

  <span style="color:#09f;font-style:italic">&lt;!-- Ingest the records tree --&gt;</span>
  <span style="color:#309;font-weight:bold">&lt;xsl:template</span> <span style="color:#309">match=</span><span style="color:#c30">&#34;records&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;Events</span> <span style="color:#309">xsi:schemaLocation=</span><span style="color:#c30">&#34;event-logging:3 file://event-logging-v3.2.3.xsd&#34;</span> <span style="color:#309">Version=</span><span style="color:#c30">&#34;3.2.3&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;xsl:apply-templates</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;/Events&gt;</span>
  <span style="color:#309;font-weight:bold">&lt;/xsl:template&gt;</span>

    <span style="color:#09f;font-style:italic">&lt;!-- Only generate events if we have an url on input --&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;xsl:template</span> <span style="color:#309">match=</span><span style="color:#c30">&#34;record[data[@name = &#39;url&#39;]]&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;Event&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;xsl:apply-templates</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;.&#34;</span> <span style="color:#309">mode=</span><span style="color:#c30">&#34;eventTime&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;xsl:apply-templates</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;.&#34;</span> <span style="color:#309">mode=</span><span style="color:#c30">&#34;eventSource&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;xsl:apply-templates</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;.&#34;</span> <span style="color:#309">mode=</span><span style="color:#c30">&#34;eventDetail&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;/Event&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;/xsl:template&gt;</span>

    <span style="color:#309;font-weight:bold">&lt;xsl:template</span> <span style="color:#309">match=</span><span style="color:#c30">&#34;node()&#34;</span>  <span style="color:#309">mode=</span><span style="color:#c30">&#34;eventTime&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;EventTime&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;TimeCreated/&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;/EventTime&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;/xsl:template&gt;</span>

    <span style="color:#309;font-weight:bold">&lt;xsl:template</span> <span style="color:#309">match=</span><span style="color:#c30">&#34;node()&#34;</span>  <span style="color:#309">mode=</span><span style="color:#c30">&#34;eventSource&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;EventSource&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;System&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;Name</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;Environment</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;/System&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;Generator</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;Device</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;Client</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;Server</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;User&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;Id</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;/User&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;/EventSource&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;/xsl:template&gt;</span>

    <span style="color:#309;font-weight:bold">&lt;xsl:template</span> <span style="color:#309">match=</span><span style="color:#c30">&#34;node()&#34;</span>  <span style="color:#309">mode=</span><span style="color:#c30">&#34;eventDetail&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;EventDetail&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;View&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;WebPage&gt;</span>
                    <span style="color:#309;font-weight:bold">&lt;Type&gt;</span>WebPage<span style="color:#309;font-weight:bold">&lt;/Type&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;/WebPage&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;/View&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;/EventDetail&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;/xsl:template&gt;</span>
<span style="color:#309;font-weight:bold">&lt;/xsl:stylesheet&gt;</span>
</code></pre></div><p><img src="../resources/v6/UI-ApacheHttpEventFeed-55.png" alt="Stroom UI ApacheHTTPDEventFeed - pipeline Stepping tab - Translation Minimal" title="Translation Minimal"></p>
<p>Clearly this doesn’t generate useful events. Our first iterative change might be to generate the TimeCreated element value. The change would be</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml">    <span style="color:#309;font-weight:bold">&lt;xsl:template</span> <span style="color:#309">match=</span><span style="color:#c30">&#34;node()&#34;</span> <span style="color:#309">mode=</span><span style="color:#c30">&#34;eventTime&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;EventTime&gt;</span>
          <span style="color:#309;font-weight:bold">&lt;TimeCreated&gt;</span>
             <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;stroom:format-date(data[@name = &#39;time&#39;]/@value, &#39;dd/MMM/yyyy:HH:mm:ss XX&#39;)&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span> 
          <span style="color:#309;font-weight:bold">&lt;/TimeCreated&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;/EventTime&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;/xsl:template&gt;</span>
</code></pre></div><p><img src="../resources/v6/UI-ApacheHttpEventFeed-56.png" alt="Stroom UI ApacheHTTPDEventFeed - pipeline Stepping tab - Translation Minimal+" title="Translation Minimal+"></p>
<p>Adding in the EventSource elements (without ANY error checking!) as per</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml">    <span style="color:#309;font-weight:bold">&lt;xsl:template</span> <span style="color:#309">match=</span><span style="color:#c30">&#34;node()&#34;</span>  <span style="color:#309">mode=</span><span style="color:#c30">&#34;eventSource&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;EventSource&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;System&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;Name&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;stroom:feed-attribute(&#39;System&#39;)&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;/Name&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;Environment&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;stroom:feed-attribute(&#39;Environment&#39;)&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;/Environment&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;/System&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;Generator&gt;</span>Apache  HTTPD<span style="color:#309;font-weight:bold">&lt;/Generator&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;Device&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;HostName&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;stroom:feed-attribute(&#39;MyHost&#39;)&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;/HostName&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;IPAddress&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;stroom:feed-attribute(&#39;MyIPAddress&#39;)&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;/IPAddress&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;/Device&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;Client&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;IPAddress&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;data[@name =  &#39;clientip&#39;]/@value&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;/IPAddress&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;Port&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;data[@name =  &#39;clientport&#39;]/@value&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;/Port&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;/Client&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;Server&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;HostName&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;data[@name =  &#39;vserver&#39;]/@value&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;/HostName&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;Port&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;data[@name =  &#39;vserverport&#39;]/@value&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;/Port&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;/Server&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;User&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;Id&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;data[@name=&#39;user&#39;]/@value&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;/Id&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;/User&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;/EventSource&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;/xsl:template&gt;</span>
</code></pre></div><p>And after a Refresh Current Step <img src="../resources/icons/stepRefresh.png" alt="stepRefresh" title="Step Refresh"> we see our output event ‘grow’ to</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-57.png" alt="Stroom UI ApacheHTTPDEventFeed - pipeline Stepping tab - Translation Minimal++" title="Translation Minimal++"></p>
<p>We now complete our translation by expanding the <em>EventDetail</em> elements to have the completed translation of (again with limited error checking and non-existent documentation!)</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#099">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span style="color:#309;font-weight:bold">&lt;xsl:stylesheet</span> <span style="color:#309">xpath-default-namespace=</span><span style="color:#c30">&#34;records:2&#34;</span> <span style="color:#309">xmlns=</span><span style="color:#c30">&#34;event-logging:3&#34;</span> <span style="color:#309">xmlns:stroom=</span><span style="color:#c30">&#34;stroom&#34;</span> <span style="color:#309">xmlns:xsl=</span><span style="color:#c30">&#34;http://www.w3.org/1999/XSL/Transform&#34;</span> <span style="color:#309">xmlns:xsi=</span><span style="color:#c30">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span style="color:#309">xmlns:xs=</span><span style="color:#c30">&#34;http://www.w3.org/2001/XMLSchema&#34;</span> <span style="color:#309">version=</span><span style="color:#c30">&#34;3.0&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>

  <span style="color:#09f;font-style:italic">&lt;!-- Ingest the records tree --&gt;</span>
  <span style="color:#309;font-weight:bold">&lt;xsl:template</span> <span style="color:#309">match=</span><span style="color:#c30">&#34;records&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;Events</span> <span style="color:#309">xsi:schemaLocation=</span><span style="color:#c30">&#34;event-logging:3 file://event-logging-v3.2.3.xsd&#34;</span> <span style="color:#309">Version=</span><span style="color:#c30">&#34;3.2.3&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;xsl:apply-templates</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;/Events&gt;</span>
  <span style="color:#309;font-weight:bold">&lt;/xsl:template&gt;</span>

    <span style="color:#09f;font-style:italic">&lt;!-- Only generate events if we have an url on input --&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;xsl:template</span> <span style="color:#309">match=</span><span style="color:#c30">&#34;record[data[@name = &#39;url&#39;]]&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;Event&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;xsl:apply-templates</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;.&#34;</span> <span style="color:#309">mode=</span><span style="color:#c30">&#34;eventTime&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;xsl:apply-templates</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;.&#34;</span> <span style="color:#309">mode=</span><span style="color:#c30">&#34;eventSource&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;xsl:apply-templates</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;.&#34;</span> <span style="color:#309">mode=</span><span style="color:#c30">&#34;eventDetail&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;/Event&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;/xsl:template&gt;</span>

    <span style="color:#309;font-weight:bold">&lt;xsl:template</span> <span style="color:#309">match=</span><span style="color:#c30">&#34;node()&#34;</span> <span style="color:#309">mode=</span><span style="color:#c30">&#34;eventTime&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;EventTime&gt;</span>
          <span style="color:#309;font-weight:bold">&lt;TimeCreated&gt;</span>
             <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;stroom:format-date(data[@name = &#39;time&#39;]/@value, &#39;dd/MMM/yyyy:HH:mm:ss XX&#39;)&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span> 
          <span style="color:#309;font-weight:bold">&lt;/TimeCreated&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;/EventTime&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;/xsl:template&gt;</span>

    <span style="color:#309;font-weight:bold">&lt;xsl:template</span> <span style="color:#309">match=</span><span style="color:#c30">&#34;node()&#34;</span>  <span style="color:#309">mode=</span><span style="color:#c30">&#34;eventSource&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;EventSource&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;System&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;Name&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;stroom:feed-attribute(&#39;System&#39;)&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;/Name&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;Environment&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;stroom:feed-attribute(&#39;Environment&#39;)&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;/Environment&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;/System&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;Generator&gt;</span>Apache  HTTPD<span style="color:#309;font-weight:bold">&lt;/Generator&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;Device&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;HostName&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;stroom:feed-attribute(&#39;MyHost&#39;)&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;/HostName&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;IPAddress&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;stroom:feed-attribute(&#39;MyIPAddress&#39;)&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;/IPAddress&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;/Device&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;Client&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;IPAddress&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;data[@name =  &#39;clientip&#39;]/@value&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;/IPAddress&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;Port&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;data[@name =  &#39;clientport&#39;]/@value&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;/Port&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;/Client&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;Server&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;HostName&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;data[@name =  &#39;vserver&#39;]/@value&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;/HostName&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;Port&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;data[@name =  &#39;vserverport&#39;]/@value&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;/Port&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;/Server&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;User&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;Id&gt;</span>
                <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;data[@name=&#39;user&#39;]/@value&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;/Id&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;/User&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;/EventSource&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;/xsl:template&gt;</span>


    <span style="color:#09f;font-style:italic">&lt;!-- --&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;xsl:template</span> <span style="color:#309">match=</span><span style="color:#c30">&#34;node()&#34;</span>  <span style="color:#309">mode=</span><span style="color:#c30">&#34;eventDetail&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;EventDetail&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;View&gt;</span>
              <span style="color:#309;font-weight:bold">&lt;WebPage&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;Type&gt;</span>WebPage<span style="color:#309;font-weight:bold">&lt;/Type&gt;</span>
                    <span style="color:#309;font-weight:bold">&lt;URL&gt;</span>
                      <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;data[@name =  &#39;url&#39;]/data[@name =  &#39;url&#39;]/@value&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
                    <span style="color:#309;font-weight:bold">&lt;/URL&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;xsl:if</span> <span style="color:#309">test=</span><span style="color:#c30">&#34;data[@name =  &#39;referer&#39;]/@value  != &#39;-&#39;&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
                    <span style="color:#309;font-weight:bold">&lt;Referrer&gt;</span>
                      <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;data[@name =  &#39;referer&#39;]/@value&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
                    <span style="color:#309;font-weight:bold">&lt;/Referrer&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;/xsl:if&gt;</span>
                    <span style="color:#309;font-weight:bold">&lt;HTTPMethod&gt;</span>
                      <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;data[@name =  &#39;url&#39;]/data[@name =  &#39;httpMethod&#39;]/@value&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
                     <span style="color:#309;font-weight:bold">&lt;/HTTPMethod&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;UserAgent&gt;</span>
                      <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;data[@name =  &#39;userAgent&#39;]/@value&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;/UserAgent&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;ResponseCode&gt;</span>
                      <span style="color:#309;font-weight:bold">&lt;xsl:value-of</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;data[@name =  &#39;response&#39;]/@value&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;/ResponseCode&gt;</span>

                  <span style="color:#09f;font-style:italic">&lt;!-- Protocol --&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;Data</span> <span style="color:#309">Name=</span><span style="color:#c30">&#34;Protocol&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
                      <span style="color:#309;font-weight:bold">&lt;xsl:attribute</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;Value&#34;</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;data[@name  =  &#39;url&#39;]/data[@name =  &#39;protocol&#39;]/@value&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;/Data&gt;</span>

                  <span style="color:#09f;font-style:italic">&lt;!-- Protocol Version --&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;Data</span>  <span style="color:#309">Name=</span><span style="color:#c30">&#34;Version&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
                      <span style="color:#309;font-weight:bold">&lt;xsl:attribute</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;Value&#34;</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;data[@name  =  &#39;url&#39;]/data[@name =  &#39;version&#39;]/@value&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;/Data&gt;</span>

                  <span style="color:#09f;font-style:italic">&lt;!--  Response Code   Before --&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;Data</span>  <span style="color:#309">Name=</span><span style="color:#c30">&#34;ResponseCodeBefore&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
                      <span style="color:#309;font-weight:bold">&lt;xsl:attribute</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;Value&#34;</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;data[@name  =  &#39;responseB&#39;]/@value&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;/Data&gt;</span>

                  <span style="color:#09f;font-style:italic">&lt;!--  Connection Status --&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;Data</span> <span style="color:#309">Name=</span><span style="color:#c30">&#34;ConnectionStatus&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
                      <span style="color:#309;font-weight:bold">&lt;xsl:attribute</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;Value&#34;</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;data[@name  =  &#39;constatus&#39;]/@value&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;/Data&gt;</span>

                  <span style="color:#09f;font-style:italic">&lt;!-- Bytes transferred  --&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;xsl:if</span> <span style="color:#309">test=</span><span style="color:#c30">&#34;data[@name =  &#39;bytesIn&#39;]/@value  != &#39;0&#39; and  data[@name =  &#39;bytesIn&#39;]/@value  != &#39;-&#39;&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;Data</span>  <span style="color:#309">Name=</span><span style="color:#c30">&#34;BytesIn&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
                      <span style="color:#309;font-weight:bold">&lt;xsl:attribute</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;Value&#34;</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;data[@name  =  &#39;bytesIn&#39;]/@value&#34;</span>  <span style="color:#309;font-weight:bold">/&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;/Data&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;/xsl:if&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;xsl:if</span> <span style="color:#309">test=</span><span style="color:#c30">&#34;data[@name =  &#39;bytesOut&#39;]/@value  != &#39;0&#39; and  data[@name =  &#39;bytesOut&#39;]/@value  != &#39;-&#39;&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;Data</span>  <span style="color:#309">Name=</span><span style="color:#c30">&#34;BytesOut&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
                      <span style="color:#309;font-weight:bold">&lt;xsl:attribute</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;Value&#34;</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;data[@name  =  &#39;bytesOut&#39;]/@value&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;/Data&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;/xsl:if&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;xsl:if</span> <span style="color:#309">test=</span><span style="color:#c30">&#34;data[@name =  &#39;bytesOutContent&#39;]/@value  != &#39;0&#39;&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;Data</span> <span style="color:#309">Name=</span><span style="color:#c30">&#34;BytesOutContentOnly&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
                      <span style="color:#309;font-weight:bold">&lt;xsl:attribute</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;Value&#34;</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;data[@name  =  &#39;bytesOutContent&#39;]/@value&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;/Data&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;/xsl:if&gt;</span>

                  <span style="color:#09f;font-style:italic">&lt;!-- Time   to serve Request --&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;xsl:if</span> <span style="color:#309">test=</span><span style="color:#c30">&#34;data[@name =  &#39;timeM&#39;]/@value != &#39;0&#39;&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;Data</span> <span style="color:#309">Name=</span><span style="color:#c30">&#34;TotalRequestTimeMicroseconds&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
                      <span style="color:#309;font-weight:bold">&lt;xsl:attribute</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;Value&#34;</span> <span style="color:#309">select=</span><span style="color:#c30">&#34;data[@name  =  &#39;timeM&#39;]/@value&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;/Data&gt;</span>
                  <span style="color:#309;font-weight:bold">&lt;/xsl:if&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;/WebPage&gt;</span>
          <span style="color:#309;font-weight:bold">&lt;/View&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;/EventDetail&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;/xsl:template&gt;</span>
<span style="color:#309;font-weight:bold">&lt;/xsl:stylesheet&gt;</span>
</code></pre></div><p>And after a Refresh Current Step Refresh <img src="../resources/icons/stepRefresh.png" alt="stepRefresh" title="Step Refresh"> we see our complete output event</p>
<p><img src="../resources/v6/UI-ApacheHttpEventFeed-58.png" alt="Stroom UI ApacheHTTPDEventFeed - pipeline Stepping tab - Translation Complete" title="Translation Complete"></p>
<p>Note, you should now Save <img src="../resources/icons/save.png" alt="save" title="Save"> your edited xslt Translation.</p>
<p>A copy of this XSLT Translation can be found  <a href="ApacheHTTPDBlackBox-TranslationXSLT.txt" title="Apache BlackBox Translation XSLT">here</a>.</p>
<p>We have completed the translation and have completed developing our Apache-SSLBlackBox-V2.0-EVENTS event feed.</p>
<p>At this point, this event feed is set up to accept Raw Event data, but it will not automatically process the raw data and hence it will not place events into the Event Store. To have Stroom automatically process Raw Event streams, you will need to enable Processors for this pipeline.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-819ae27ddbe9037ce3d20bee44a67c5e">2 - Event Processing</h1>
    <div class="lead">This HOWTO is provided to assist users in setting up Stroom to process inbound raw event logs and transform them into the Stroom Event Logging XML Schema.</div>
	<h2 id="assumptions">Assumptions</h2>
<p>The following assumptions are used in this document.</p>
<ul>
<li>the user successfully deployed Stroom</li>
<li>the following Stroom content packages have been installed
<ul>
<li>Template Pipelines</li>
<li>XML Schemas</li>
</ul>
</li>
</ul>
<h2 id="introduction">Introduction</h2>
<p>This HOWTO will demonstrate the process by which an Event Processing pipeline for a given Event Source is developed and deployed.</p>
<p>The sample event source used will be based on BlueCoat Proxy logs. An extract of BlueCoat logs were sourced from <a href="http://log-sharing.dreamhosters.com">http://log-sharing.dreamhosters.com</a> (a Public Security Log Sharing Site) but modified to add sample user attribution.</p>
<p>Template pipelines are being used to simplify the establishment of this processing pipeline.</p>
<p>The sample BlueCoat Proxy log will be transformed into an intermediate simple XML key value pair structure, then into the <a href="https://github.com/gchq/event-logging-schema">Stroom Event Logging XML Schema (external link)</a> format.</p>
<h2 id="event-source">Event Source</h2>
<p>As mentioned, we will use BlueCoat Proxy logs as a sample event source. Although BlueCoat logs can be customised, the default is to use the W2C Extended Log File Format (ELF). Our sample data set looks like</p>
<pre><code>#Software: SGOS 3.2.4.28
#Version: 1.0
#Date: 2005-04-27 20:57:09
#Fields: date time time-taken c-ip sc-status s-action sc-bytes cs-bytes cs-method cs-uri-scheme cs-host cs-uri-path cs-uri-query cs-username s-hierarchy s-supplier-name rs(Content-Type) cs(User-Agent) sc-filter-result sc-filter-category x-virus-id s-ip s-sitename x-virus-details x-icap-error-code x-icap-error-details
2005-05-04 17:16:12 1 45.110.2.82 200 TCP_HIT 941 729 GET http www.inmobus.com /wcm/assets/images/imagefileicon.gif - george DIRECT 38.112.92.20 image/gif &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&quot; PROXIED none - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:12 2 45.110.2.82 200 TCP_HIT 941 729 GET http www.inmobus.com /wcm/assets/images/imagefileicon.gif - george DIRECT 38.112.92.20 image/gif &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&quot; PROXIED none - 192.16.170.42 SG-HTTP-Service - none -
...
</code></pre>
<p>A copy of this sample data source can be found <a href="sampleBluecoat.log" title="Sample BlueCoat logs">here</a>.
Later in this HOWTO, one will be required to upload this file. If you save this file now, ensure the file is saved
as a text document with ANSI encoding.</p>
<h2 id="establish-the-processing-pipeline">Establish the Processing Pipeline</h2>
<p>We will create the components that make up the processing pipeline for transforming these raw logs into the Stroom Event Logging XML Schema.
They will be placed a folder appropriately named <strong>BlueCoat</strong> in the path <strong>System/Event Sources/Proxy</strong>. See <a href="../General/FeedManagementHowTo.md#create-folder-for-specific-event-source" title="Folder creation">Folder Creation</a> for details on creating such a folder.</p>
<p>There will be four components</p>
<ul>
<li>the Event Feed to group the BlueCoat log files</li>
<li>the Text Converter to convert the BlueCoat raw logs files into simple XML</li>
<li>the XSLT Translation to translate the simple XML formed by the Text Converter into the Stroom Event Logging XML form, and</li>
<li>the Processing pipeline which manages how the processing is performed.</li>
</ul>
<p>All components will have the same Name <strong>BlueCoat-Proxy-V1.0-EVENTS</strong>. It should be noted that the default Stroom FeedName pattern will not accept this name. One needs to modify the <code>stroom.feedNamePattern</code> stroom property to change the default pattern to <code>^[a-zA-Z0-9_-\.]{3,}$</code>. See the <a href="../Administration/SystemProperties.md" title="System Properties">HOWTO on System Properties</a> docment to see how to make this change.</p>
<h3 id="create-the-event-feed">Create the Event Feed</h3>
<p>We first select (with a <em>left click</em>) the <strong>System/Event Sources/Proxy/BlueCoat</strong> folder in the <code>Explorer</code> tab then <em>right click</em> to bring up the <code>New Item</code> selection sub-menu.</p>
<p><img src="../resources/UI-CreateFeed-01.png" alt="Stroom New Item"></p>
<p>As we are creating an Event Feed, select the <img src="../resources/icons/feedItem.png" alt="Stroom UI FeedItem" title="Stroom UI FeedItem"> item to have the <code>New Feed</code> configuration window into which we enter <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> into the <code>Name:</code> entry box</p>
<p><img src="../resources/UI-FeedProcessing-00.png" alt="Stroom UI Create Feed - New Feed Configuration name" title="Stroom UI Create Feed - New feed configuration window enter name"></p>
<p>and press <img src="../resources/icons/buttonOk.png" alt="Stroom UI OkButton" title="Stroom UI OkButton"> to see the new Event Feed tab</p>
<p><img src="../resources/UI-FeedProcessing-01.png" alt="Stroom UI Create Feed - New Feed Tab" title="Stroom UI Create Feed - New feed tab"></p>
<p>and it&rsquo;s corresponding reference in the <code>Explorer</code> display.</p>
<p>The configuration items for a Event Feed are</p>
<ul>
<li>Description - a description of the feed</li>
<li>Classification - the classification or sensitivity of the Event Feed data</li>
<li>Reference Feed Flag - to indicate if this is a <code>Reference Feed</code> or not</li>
<li>Feed Status - which indicates if we accept data, reject it or silently drop it</li>
<li>Stream Type - to indicate if the <code>Feed</code> contains raw log data or reference data</li>
<li>Data Encoding - the character encoding of the data being sent to the <code>Feed</code></li>
<li>Context Encoding - the character encoding of context data associated with this <code>Feed</code></li>
<li>Retention Period - the amount of time to retain the Event data</li>
</ul>
<p>In our example, we will set the above to</p>
<ul>
<li>Description - <em>BlueCoat Proxy log data sent in W2C Extended Log File Format (ELFF)</em></li>
<li>Classification - We will leave this blank</li>
<li>Reference Feed Flag - We leave the check-box unchecked as this is not a <em>Reference Feed</em></li>
<li>Feed Status - We set to <em>Receive</em></li>
<li>Stream Type - We set to <em>Raw Events</em> as we will be sending batches (streams) of raw event logs</li>
<li>Data Encoding - We leave at the default of <em>UTF-8</em> as this is the proposed character encoding</li>
<li>Context Encoding - We leave at the default of <em>UTF-8</em> as there are no Context Events for this Feed</li>
<li>Retention Period - We leave at <em>Forever</em> was we do not want to delete any collected BlueCoat event data.</li>
</ul>
<p><img src="../resources/UI-FeedProcessing-02.png" alt="Stroom UI Create Feed - New Feed Tab Configuration" title="Stroom UI Create Feed - New feed tab configuration"></p>
<p>One should note that the <code>Feed</code> tab as been marked as having unsaved changes. This is indicated by the asterisk
character <code>*</code> between the <em>Feed</em> icon <img src="../resources/icons/feed.png" alt="Feed" title="Feed"> and the name of the feed <strong>BlueCoat-Proxy-V1.0-EVENTS</strong>.
We can save the changes to our feed by pressing the <em>Save</em> icon <img src="../resources/icons/save.png" alt="Save" title="Save"> in
the top left of the <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> tab. At this point one should notice two things, the first is that the asterisk
has disappeared from the <code>Feed</code> tab and the the second is that the <em>Save</em> icon <img src="../resources/icons/save.png" alt="Save" title="Save"> is now <em>ghosted</em> - <img src="../resources/icons/ghostedSave.png" alt="ghostedSave" title="Ghosted Save">.</p>
<p><img src="../resources/UI-FeedProcessing-03.png" alt="Stroom UI Create Feed - New Feed Tab Saved" title="Stroom UI Create Feed - New feed tab saved"></p>
<h3 id="create-the-text-converter">Create the Text Converter</h3>
<p>We now create the Text Converter for this <code>Feed</code> in a similar fashion to the <code>Event Feed</code>.
We first select (with a <em>left click</em>) the <strong>System/Event Sources/Proxy/BlueCoat</strong> folder in the <code>Explorer</code> tab then <em>right click</em> to bring up the <code>New Item</code> selection sub-menu. As we are creating a Text Converter, select the <img src="../resources/icons/textConverterItem.png" alt="Stroom UI textConverterItem" title="Stroom UI TextConverterItem"> item to have the <code>New Text Converter</code> configuration window.</p>
<p>Enter <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> into the <code>Name:</code> entry box and press the <img src="../resources/icons/buttonOk.png" alt="Stroom UI OkButton" title="Stroom UI OkButton"> which results in the creation of the Text Converter tab</p>
<p><img src="../resources/UI-FeedProcessing-04.png" alt="Stroom UI Create Feed - New TextConverter Tab" title="Stroom UI Create Feed - New TextConverter tab"></p>
<p>and it&rsquo;s corresponding reference in the <code>Explorer</code> display.</p>
<p>We set the configuration for this <code>Text Converter</code> to be</p>
<ul>
<li>Description - <em>Simple XML transform for BlueCoat Proxy log data sent in W2C Extended Log File Format (ELFF)</em></li>
<li>Converter Type - We set to <em>Data Splitter</em> was we will be using the Stroom Data Splitter facility to convert the raw log data into simple XML.</li>
</ul>
<p>Again, press the <em>Save</em> icon <img src="../resources/icons/save.png" alt="Save" title="Save"> to save the configuration items.</p>
<h3 id="create-the-xslt-translation">Create the XSLT Translation</h3>
<p>We now create the XSLT translation for this <code>Feed</code> in a similar fashion to the <code>Event Feed</code> or <code>Text Converter</code>.
We first select (with a <em>left click</em>) the <strong>System/Event Sources/Proxy/BlueCoat</strong> folder in the <code>Explorer</code> tab then <em>right click</em> to bring up the <code>New Item</code> selection sub-menu. As we are creating a XSLT Translation, select the <img src="../resources/icons/xsltItem.png" alt="Stroom UI xsltItem" title="Stroom UI xsltItem"> item to have the <code>New XSLT</code> configuration window.</p>
<p>Enter <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> into the <code>Name:</code> entry box and press the <img src="../resources/icons/buttonOk.png" alt="Stroom UI OkButton" title="Stroom UI OkButton"> which results in the creation of the XSLT Translation tab</p>
<p><img src="../resources/UI-FeedProcessing-05.png" alt="Stroom UI Create Feed - New Translation Tab" title="Stroom UI Create Feed - New Translation tab"></p>
<p>and it&rsquo;s corresponding reference in the <code>Explorer</code> display.</p>
<p>We set the configuration for this <code>XSLT Translation</code> to be</p>
<ul>
<li>Description - <em>Transform simple XML of BlueCoat Proxy log data into Stroom Event Logging XML form</em></li>
</ul>
<p>Again, press the <em>Save</em> icon <img src="../resources/icons/save.png" alt="Save" title="Save"> to save the configuration items.</p>
<h3 id="create-the-pipeline">Create the Pipeline</h3>
<p>We now create the Pipeline for this <code>Feed</code> in a similar fashion to the <code>Event Feed</code>, <code>Text Converter</code> or <code>XSLT Translation</code>.
We first select (with a <em>left click</em>) the <strong>System/Event Sources/Proxy/BlueCoat</strong> folder in the <code>Explorer</code> tab then <em>right click</em> to bring up the <code>New Item</code> selection sub-menu. As we are creating a Pipeline, select the <img src="../resources/icons/pipeLineItem.png" alt="Stroom UI pipeLineItem" title="Stroom UI pipeLineItem"> item to have the <code>New Pipeline</code> configuration window.</p>
<p>Enter <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> into the <code>Name:</code> entry box and press the <img src="../resources/icons/buttonOk.png" alt="Stroom UI OkButton" title="Stroom UI OkButton"> which results in the creation of the Pipeline tab</p>
<p><img src="../resources/UI-FeedProcessing-06.png" alt="Stroom UI Create Feed - New Pipeline Tab" title="Stroom UI Create Feed - New Pipeline tab"></p>
<p>and it&rsquo;s corresponding reference in the <code>Explorer</code> display.</p>
<p>We set the configuration for this <code>Pipeline</code> to be</p>
<ul>
<li>Description - <em>Processing of XML of BlueCoat Proxy log data into Stroom Event Logging XML</em></li>
<li>Type - We leave as <em>Event Data</em> as this is an <em>Event Data</em> pipeline</li>
</ul>
<h4 id="configure-pipeline-structure">Configure Pipeline Structure</h4>
<p>We now need to configure the <em>Structure</em> of this <code>Pipeline</code>.</p>
<p>We do this by selecting the <code>Structure</code> hyper-link of the *<em>BlueCoat-Proxy-V1.0-EVENTS</em> <code>Pipeline</code> tab.</p>
<p>At this we see the <code>Pipeline Structure</code> configuration tab</p>
<p><img src="../resources/UI-FeedProcessing-07.png" alt="Stroom UI Create Feed - Pipeline Structure" title="Stroom UI Create Feed - Pipeline Structure tab"></p>
<p>As noted in the Assumptions at the start, we have loaded the <strong>Template Pipeline</strong> content pack, so that we can <em>Inherit</em> a pipeline structure from this content pack and configure it to support this specific feed.</p>
<p>We find a template by selecting the <strong>Inherit From:</strong> entry box labeled <img src="../resources/icons/noneEntryBox.png" alt="Stroom UI noneEntryBox" title="Stroom UI NoneEntryBox"> to reveal a <strong>Choose Item</strong> configuration item window.</p>
<p><img src="../resources/UI-FeedProcessing-08.png" alt="Stroom UI Create Feed - Pipeline Structure - Inherit" title="Stroom UI Create Feed - Pipeline Structure tab - Inherit"></p>
<p>Select the <strong>Template Pipelines</strong> folder by pressing the <img src="../resources/icons/openFolder.png" alt="Stroom UI openFolder" title="Stroom UI Open Folder"> icon to the left of the folder to reveal the choice of available templates.</p>
<p><img src="../resources/UI-FeedProcessing-09.png" alt="Stroom UI Create Feed - Pipeline Structure - Templates" title="Stroom UI Create Feed - Pipeline Structure tab - Templates"></p>
<p>For our BlueCoat feed we will select the <code>Event Data (Text)</code> template. This is done by moving the cursor to the relevant line and select via a <em>left click</em></p>
<p><img src="../resources/UI-FeedProcessing-10.png" alt="Stroom UI Create Feed - Pipeline Structure - Template Selection" title="Stroom UI Create Feed - Pipeline Structure tab - Template Selection"></p>
<p>then pressing <img src="../resources/icons/buttonOk.png" alt="Stroom UI OkButton" title="Stroom UI OkButton"> to see the inherited pipeline structure</p>
<p><img src="../resources/UI-FeedProcessing-11.png" alt="Stroom UI Create Feed - Pipeline Structure - Template Selected" title="Stroom UI Create Feed - Pipeline Structure tab - Template Selected"></p>
<h4 id="configure-pipeline-elements">Configure Pipeline Elements</h4>
<p>For the purpose of this HOWTO, we are only interested in two of the eleven (11) elements in this pipeline</p>
<ul>
<li>the Text Converter labeled <em>dsParser</em></li>
<li>the XSLT Translation labeled <em>translationFilter</em></li>
</ul>
<p>We need to assign our BlueCoat-Proxy-V1.0-EVENTS Text Converter and XSLT Translation to these elements respectively.</p>
<h5 id="text-converter-configuration">Text Converter Configuration</h5>
<p>We do this by first selecting (<em>left click</em>) the <em>dsParser</em> element at which we see the <em>Property</em> sub-window displayed</p>
<p><img src="../resources/UI-FeedProcessing-12.png" alt="Stroom UI Create Feed - Pipeline Structure - dsParser" title="Stroom UI Create Feed - Pipeline Structure tab - dsParser"></p>
<p>We then select (<em>left click</em>) the <em>textConverter</em> <strong>Property Name</strong></p>
<p><img src="../resources/UI-FeedProcessing-13.png" alt="Stroom UI Create Feed - Pipeline Structure - dsParser selected Property" title="Stroom UI Create Feed - Pipeline Structure tab - dsParser selected Property"></p>
<p>then press the <code>Edit Property</code> button <img src="../resources/icons/edit.png" alt="Stroom UI EditProperty" title="Stroom UI EditButton">.  At this, the <code>Edit Property</code> configuration window is displayed.</p>
<p><img src="../resources/UI-FeedProcessing-14.png" alt="Stroom UI Create Feed - Pipeline Structure - dsParser edit Property" title="Stroom UI Create Feed - Pipeline Structure tab - dsParser Edit Property"></p>
<p>We select the <strong>Value:</strong> entry box labeled <img src="../resources/icons/noneEntryBox.png" alt="Stroom UI noneEntryBox" title="Stroom UI NoneEntryBox"> to reveal a <strong>Choose Item</strong> configuration item window.</p>
<p><img src="../resources/UI-FeedProcessing-15.png" alt="Stroom UI Create Feed - Pipeline Structure - dsParser edit Property choose item" title="Stroom UI Create Feed - Pipeline Structure tab - dsParser Edit Property choose item"></p>
<p>We traverse the folder structure until we can select the <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> <code>Text Converter</code> as per</p>
<p><img src="../resources/UI-FeedProcessing-16.png" alt="Stroom UI Create Feed - Pipeline Structure - dsParser edit Property chosen item" title="Stroom UI Create Feed - Pipeline Structure tab - dsParser Edit Property chosen item"></p>
<p>and then press the <img src="../resources/icons/buttonOk.png" alt="Stroom UI OkButton" title="Stroom UI OkButton"> to see that the Property <strong>Value:</strong> has been selected.</p>
<p><img src="../resources/UI-FeedProcessing-17.png" alt="Stroom UI Create Feed - Pipeline Structure - dsParser set Property chosen item" title="Stroom UI Create Feed - Pipeline Structure tab - dsParser set Property chosen item"></p>
<p>and pressing the <img src="../resources/icons/buttonOk.png" alt="Stroom UI OkButton" title="Stroom UI OkButton"> button of the <code>Edit Property</code> configuration window results in the pipelines <code>dsParser</code> property being set.</p>
<p><img src="../resources/UI-FeedProcessing-18.png" alt="Stroom UI Create Feed - Pipeline Structure - dsParser set Property" title="Stroom UI Create Feed - Pipeline Structure tab - dsParser set Property"></p>
<h5 id="xslt-translation-configuration">XSLT Translation Configuration</h5>
<p>We do this by first selecting (<em>left click</em>) the <em>translationFilter</em> element at which we see the <em>Property</em> sub-window displayed</p>
<p><img src="../resources/UI-FeedProcessing-19.png" alt="Stroom UI Create Feed - Pipeline Structure - translationFilter" title="Stroom UI Create Feed - Pipeline Structure tab - translationFilter"></p>
<p>We then select (<em>left click</em>) the <em>xslt</em> <strong>Property Name</strong></p>
<p><img src="../resources/UI-FeedProcessing-20.png" alt="Stroom UI Create Feed - Pipeline Structure - xslt selected Property" title="Stroom UI Create Feed - Pipeline Structure tab - xslt selected Property"></p>
<p>and following the same steps as for the Text Converter property selection, we assign the <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> <code>XSLT Translation</code> to the <code>xslt</code> property.</p>
<p><img src="../resources/UI-FeedProcessing-21.png" alt="Stroom UI Create Feed - Pipeline Structure - xslt selected Property" title="Stroom UI Create Feed - Pipeline Structure tab - xslt selected Property"></p>
<p>At this point, we save these changes by pressing the <em>Save</em> icon <img src="../resources/icons/save.png" alt="Save" title="Save">.</p>
<h2 id="authoring-the-translation">Authoring the Translation</h2>
<p>We are now ready to author the translation. Close all tabs except for the <strong>Welcome</strong> and <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> <code>Feed</code> tabs.</p>
<p>On the <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> <code>Feed</code> tab, select the <strong>Data</strong> hyper-link to be presented with the <strong>Data</strong> pane of our tab.</p>
<p><img src="../resources/UI-FeedProcessing-22.png" alt="Stroom UI Create Feed - Translation - Data Pane" title="Stroom UI Create Feed - Translation - Data Pane"></p>
<p>Although we can post our test data set to this feed, we will manually upload it via the <strong>Data</strong> pane. To do this we press the Upload button <img src="../resources/icons/buttonOk.png" alt="Stroom UI OkButton" title="Stroom UI OkButton"> in the top <strong>Data</strong> pane to display the <code>Upload</code> configuration window</p>
<p><img src="../resources/UI-FeedProcessing-23.png" alt="Stroom UI Create Feed - Translation - Data Pane Upload" title="Stroom UI Create Feed - Translation - Data Pane Upload"></p>
<p>In a <em>Production</em> situation, where we would post log files to Stroom, we would include certain HTTP Header variables that, as we shall see, will be used
as part of the translation. These header variables typically provide situational awareness of the source system sending the events.</p>
<p>For our purposes we set the following HTTP Header variables</p>
<pre><code>Environment:Development
LogFileName:sampleBluecoat.log
MyHost:&quot;somenode.strmdev00.org&quot;
MyIPaddress:&quot;192.168.2.220 192.168.122.1&quot;
MyMeta:&quot;FQDN:somenode.strmdev00.org\nipaddress:192.168.2.220\nipaddress_eth0:192.168.2.220\nipaddress_lo:127.0.0.1\nipaddress_virbr0:192.168.122.1\n&quot;
MyNameServer:&quot;gateway.strmdev00.org.&quot;
MyTZ:+1000
Shar256:056f0d196ffb4bc6c5f3898962f1708886bb48e2f20a81fb93f561f4d16cb2aa
System:Site http://log-sharing.dreamhosters.com/ Bluecoat Logs
Version:V1.0
</code></pre>
<p>These are set by entering them into the <strong>Meta Data:</strong> entry box.</p>
<p><img src="../resources/UI-FeedProcessing-24b.png" alt="Stroom UI Create Feed - Translation - Data Pane Upload Metadata" title="Stroom UI Create Feed - Translation - Data Pane Upload Metadata"></p>
<p>Having done this we select a <strong>Stream Type:</strong> of <code>Raw Events</code></p>
<p>We leave the <strong>Effective:</strong> entry box empty as this stream of raw event logs does not have an <code>Effective Date</code> (only Reference Feeds set this).</p>
<p>And we choose our file <code>sampleBluecoat.log</code>, by clicking on the <code>Browse</code> button in the <strong>File:</strong> entry box, which brings up the brower&rsquo;s standard file upload selection window. Having selected our file, we see</p>
<p><img src="../resources/UI-FeedProcessing-24.png" alt="Stroom UI Create Feed - Translation - Data Pane Upload Complete" title="Stroom UI Create Feed - Translation - Data Pane Upload Complete"></p>
<p>On pressing <img src="../resources/icons/buttonOk.png" alt="Stroom UI OkButton" title="Stroom UI OkButton"> and <code>Alert</code> pop-up window is presented indicating the file was uploaded</p>
<p><img src="../resources/UI-FeedProcessing-25.png" alt="Stroom UI Create Feed - Translation - Data Pane Upload Complete Verify" title="Stroom UI Create Feed - Translation - Data Pane Upload Complete Verify"></p>
<p>Again press <img src="../resources/icons/buttonClose.png" alt="Stroom UI CloseButton" title="Stroom UI CloseButton"> to show that the data has been uploaded as a Stream into the <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> Event Feed.</p>
<p><img src="../resources/UI-FeedProcessing-26.png" alt="Stroom UI Create Feed - Translation - Data Pane Show Batch" title="Stroom UI Create Feed - Translation - Data Pane Show Batch"></p>
<p>The top pane holds a table of the latest streams that pertain to the feed. We see the one item which is the stream we uploaded. If we select it, we see that a stream summary is also displayed in the centre pane (which shows details of the <em>specific</em> selected feed and associated streams. We also see that the bottom pane displays the data associated with the selected item. In this case, the first lines of content from the BlueCoat sample log file.</p>
<p><img src="../resources/UI-FeedProcessing-27.png" alt="Stroom UI Create Feed - Translation - Data Pane Show Data" title="Stroom UI Create Feed - Translation - Data Pane Show Data"></p>
<p>If we were to select the <strong>Meta</strong> hyper-link of the lower pane, one would see the metadata Stroom records for this Stream of data.</p>
<p><img src="../resources/UI-FeedProcessing-28.png" alt="Stroom UI Create Feed - Translation - MetaData Pane Show Data" title="Stroom UI Create Feed - Translation - MetaData Pane Show Data"></p>
<p>You should see all the HTTP variables we set as part of the Upload step as well as some that Stroom has automatically set.</p>
<p>We now switch back to the <strong>Data</strong> hyper-link before we start to develop the actual translation.</p>
<h3 id="stepping-the-pipeline">Stepping the Pipeline</h3>
<p>We will now author the two translation components of the pipeline, the data splitter that will transform our lines of BlueCoat data into a simple xml format and then the XSLT translation that will take this simple xml format and translate it into appropriate Stroom Event Logging XML form.</p>
<p>We start by ensuring our <code>Raw Events</code> Data stream is selected and we press the <code>Enter Stepping Mode</code> <img src="../resources/icons/enterStepping.png" alt="Stroom UI enterStepping Mode" title="Stroom UI Enter Stepping"> button on the lower right hand side of the bottom <code>Stream Data</code> pane.</p>
<p>You will be prompted to select a pipeline to step with. Choose the <code>BlueCoat-Proxy-V1.0-EVENTS</code> pipeline</p>
<p><img src="../resources/UI-FeedProcessing-29.png" alt="Stroom UI Create Feed - Translation - Stepping Choose Pipeline" title="Stroom UI Create Feed - Translation - Stepping Choose Pipeline"></p>
<p>then press <img src="../resources/icons/buttonOk.png" alt="Stroom UI OkButton" title="Stroom UI OkButton">.</p>
<h3 id="stepping-the-pipeline---source">Stepping the Pipeline - Source</h3>
<p>You will be presented with the <code>Source</code> element of the pipeline that shows our selected stream&rsquo;s raw data.</p>
<p><img src="../resources/UI-FeedProcessing-30.png" alt="Stroom UI Create Feed - Translation - Stepping Source Element" title="Stroom UI Create Feed - Translation - Stepping Source Element"></p>
<p>We see two panes here.</p>
<p>The top pane displays the Pipeline structure with <code>Source</code> selected (we could refer to this as the <em>stepping pane</em>) and it also displays a <em>step indicator</em> (three colon separated numbers enclosed in square brackets initially the numbers are dashes i.e. <code>[-:-:-]</code> as we have yet to step) and a set of green <em>Stepping Actions</em>. The step indicator and Stepping Actions allows one the <em>step through</em> a log file, selecting data event by event (an event is typically a line, but some events can be multi-line).</p>
<p>The bottom pane displays the first page (up to 100 lines) of data along with a set of blue <em>Data Selection Actions</em>. The Data Selection Actions are used to step through the source data 100 lines at a time. When multiple source log files have been aggregated into a single stream, two <em>Data Selection Actions</em> control buttons will be offered. The right hand one will allow a user to step though the source data as before, but the left hand set of control buttons allows one to step between files from the aggregated event log files.</p>
<h3 id="stepping-the-pipeline---dsparser">Stepping the Pipeline - dsParser</h3>
<p>We now select the <code>dsParser</code> pipeline element that results in the window below</p>
<p><img src="../resources/UI-FeedProcessing-31.png" alt="Stroom UI Create Feed - Translation - Stepping dsParser Element" title="Stroom UI Create Feed - Translation - Stepping dsParser Element"></p>
<p>This window is made up of four panes.</p>
<p>The top pane remains the same - a display of the pipeline structure and the <em>step indicator</em> and green <em>Stepping Actions</em>.</p>
<p>The next pane down is the editing pane for the Text Converter. This pane is used to edit the text converter that converts our <em>line based</em> BlueCoat Proxy logs into a XML format. We make use of the Stroom Data Splitter facility to perform this transformation. See <a href="../../datasplitter/1-0-introduction.md">here</a> for complete details on the data splitter.</p>
<p>The lower two panes are the <em>input</em> and <em>output</em> displays for the text converter.</p>
<p>The authoring of this data splitter translation is outside the scope of this HOWTO. It is recommended that one reads up on the <a href="../../datasplitter/1-0-introduction.md">Data Splitter</a> and review the various samples found in the Stroom Context packs published, or the Pull Requests of <a href="https://github.com/gchq/stroom-content">https://github.com/gchq/stroom-content</a>.</p>
<p>For the purpose of this HOWTO, the Datasplitter appears below. The author believes the comments should support the understanding of the transformation.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xslt" data-lang="xslt"><span style="color:#099">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
&lt;<span style="color:#309;font-weight:bold">dataSplitter</span> <span style="color:#309">bufferSize</span><span style="color:#555">=</span><span style="color:#c30">&#34;5000000&#34;</span> <span style="color:#309">xmlns</span><span style="color:#555">=</span><span style="color:#c30">&#34;data-splitter:3&#34;</span> <span style="color:#309">xmlns:xsi</span><span style="color:#555">=</span><span style="color:#c30">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span style="color:#309">xsi:schemaLocation</span><span style="color:#555">=</span><span style="color:#c30">&#34;data-splitter:3 file://data-splitter-v3.0.xsd&#34;</span> <span style="color:#309">version</span><span style="color:#555">=</span><span style="color:#c30">&#34;3.0&#34;</span> <span style="color:#309">ignoreErrors</span><span style="color:#555">=</span><span style="color:#c30">&#34;true&#34;</span>&gt;

  <span style="color:#09f;font-style:italic">&lt;!-- 
</span><span style="color:#09f;font-style:italic">  This datasplitter gains the Software and and Proxy version strings along with the log field names from the comments section of the log file.
</span><span style="color:#09f;font-style:italic">  That is from the lines ...
</span><span style="color:#09f;font-style:italic">  
</span><span style="color:#09f;font-style:italic">  #Software: SGOS 3.2.4.28
</span><span style="color:#09f;font-style:italic">  #Version: 1.0
</span><span style="color:#09f;font-style:italic">  #Date: 2005-04-27 20:57:09
</span><span style="color:#09f;font-style:italic">  #Fields: date time time-taken c-ip sc-status s-action sc-bytes cs-bytes cs-method ... x-icap-error-code x-icap-error-details
</span><span style="color:#09f;font-style:italic">  
</span><span style="color:#09f;font-style:italic">  We use the Field values as the header for the subsequent log fields
</span><span style="color:#09f;font-style:italic">  --&gt;</span>
  
  <span style="color:#09f;font-style:italic">&lt;!-- Match the software comment line and save it in _bc_software --&gt;</span>
  &lt;<span style="color:#309;font-weight:bold">regex</span> <span style="color:#309">id</span><span style="color:#555">=</span><span style="color:#c30">&#34;software&#34;</span> <span style="color:#309">pattern</span><span style="color:#555">=</span><span style="color:#c30">&#34;^#Software: (.+) ?\n*&#34;</span>&gt;
    &lt;<span style="color:#309;font-weight:bold">data</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;_bc_software&#34;</span> <span style="color:#309">value</span><span style="color:#555">=</span><span style="color:#c30">&#34;$1&#34;</span> /&gt;
  &lt;/<span style="color:#309;font-weight:bold">regex</span>&gt;
    <span style="color:#09f;font-style:italic">&lt;!-- Match the version comment line and save it in _bc_version --&gt;</span>

  &lt;<span style="color:#309;font-weight:bold">regex</span> <span style="color:#309">id</span><span style="color:#555">=</span><span style="color:#c30">&#34;version&#34;</span> <span style="color:#309">pattern</span><span style="color:#555">=</span><span style="color:#c30">&#34;^#Version: (.+) ?\n*&#34;</span>&gt;
    &lt;<span style="color:#309;font-weight:bold">data</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;_bc_version&#34;</span> <span style="color:#309">value</span><span style="color:#555">=</span><span style="color:#c30">&#34;$1&#34;</span> /&gt;
  &lt;/<span style="color:#309;font-weight:bold">regex</span>&gt;

  <span style="color:#09f;font-style:italic">&lt;!-- Match against a Fields: header comment and save all the field names in a headings --&gt;</span>
  
  &lt;<span style="color:#309;font-weight:bold">regex</span> <span style="color:#309">id</span><span style="color:#555">=</span><span style="color:#c30">&#34;heading&#34;</span> <span style="color:#309">pattern</span><span style="color:#555">=</span><span style="color:#c30">&#34;^#Fields: (.+) ?\n*&#34;</span>&gt;
    &lt;<span style="color:#309;font-weight:bold">group</span> <span style="color:#309">value</span><span style="color:#555">=</span><span style="color:#c30">&#34;$1&#34;</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">regex</span> <span style="color:#309">pattern</span><span style="color:#555">=</span><span style="color:#c30">&#34;^(\S+) ?\n*&#34;</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">var</span> <span style="color:#309">id</span><span style="color:#555">=</span><span style="color:#c30">&#34;headings&#34;</span> /&gt;
      &lt;/<span style="color:#309;font-weight:bold">regex</span>&gt;
    &lt;/<span style="color:#309;font-weight:bold">group</span>&gt;
  &lt;/<span style="color:#309;font-weight:bold">regex</span>&gt;

  <span style="color:#09f;font-style:italic">&lt;!-- Skip all other comment lines --&gt;</span>
  &lt;<span style="color:#309;font-weight:bold">regex</span> <span style="color:#309">pattern</span><span style="color:#555">=</span><span style="color:#c30">&#34;^#.+\n*&#34;</span>&gt;
    &lt;<span style="color:#309;font-weight:bold">var</span> <span style="color:#309">id</span><span style="color:#555">=</span><span style="color:#c30">&#34;ignorea&#34;</span> /&gt;
  &lt;/<span style="color:#309;font-weight:bold">regex</span>&gt;

  <span style="color:#09f;font-style:italic">&lt;!-- We now match all other lines, applying the headings captured at the start of the file to each field value --&gt;</span>
  
  &lt;<span style="color:#309;font-weight:bold">regex</span> <span style="color:#309">id</span><span style="color:#555">=</span><span style="color:#c30">&#34;body&#34;</span> <span style="color:#309">pattern</span><span style="color:#555">=</span><span style="color:#c30">&#34;^[^#].+\n*&#34;</span>&gt;
    &lt;<span style="color:#309;font-weight:bold">group</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">regex</span> <span style="color:#309">pattern</span><span style="color:#555">=</span><span style="color:#c30">&#34;^&amp;#34;([^&amp;#34;]*)&amp;#34; ?\n*&#34;</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">data</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;$headings$1&#34;</span> <span style="color:#309">value</span><span style="color:#555">=</span><span style="color:#c30">&#34;$1&#34;</span> /&gt;
      &lt;/<span style="color:#309;font-weight:bold">regex</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">regex</span> <span style="color:#309">pattern</span><span style="color:#555">=</span><span style="color:#c30">&#34;^([^ ]+) *\n*&#34;</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">data</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;$headings$1&#34;</span> <span style="color:#309">value</span><span style="color:#555">=</span><span style="color:#c30">&#34;$1&#34;</span> /&gt;
      &lt;/<span style="color:#309;font-weight:bold">regex</span>&gt;
    &lt;/<span style="color:#309;font-weight:bold">group</span>&gt;
  &lt;/<span style="color:#309;font-weight:bold">regex</span>&gt;

  <span style="color:#09f;font-style:italic">&lt;!-- --&gt;</span>
&lt;/<span style="color:#309;font-weight:bold">dataSplitter</span>&gt;
</code></pre></div><p>It should be entered into the Text Converter&rsquo;s editing pane as per</p>
<p><img src="../resources/UI-FeedProcessing-32.png" alt="Stroom UI Create Feed - Translation - Stepping dsParser textConverter code" title="Stroom UI Create Feed - Translation - Stepping dsParser textConverter code"></p>
<p>A copy of this DataSplitter can be found <a href="BlueCoat.ds" title="BlueCoat dataspliter">here</a>.</p>
<p>As mentioned earlier, to <em>step</em> the translation, one uses the green  <em>Stepping Actions</em>.</p>
<p>The actions are</p>
<ul>
<li><img src="../resources/icons/stepFirst.png" alt="stepFirst" title="Step First"> - progress the transformation to the first line of the translation input</li>
<li><img src="../resources/icons/stepBack.png" alt="stepBack" title="Step Back"> - progress the transformation one step backward</li>
<li><img src="../resources/icons/stepForward.png" alt="stepForward" title="Step Forward"> - progress the transformation one step forward</li>
<li><img src="../resources/icons/stepLast.png" alt="stepLast" title="Step Last"> - progress the transformation to the end of the translation input</li>
<li><img src="../resources/icons/stepRefresh.png" alt="stepRefresh" title="Refresh Current Step"> - refresh the transformation based on the current translation input</li>
</ul>
<p>So, if one was to press the <img src="../resources/icons/stepForward.png" alt="stepForward" title="Step Forward"> <em>stepping action</em> we would be presented with</p>
<p><img src="../resources/UI-FeedProcessing-33.png" alt="Stroom UI Create Feed - Translation - Stepping dsParser textConverter 1" title="Stroom UI Create Feed - Translation - Stepping dsParser textConverter 1"></p>
<p>We see that the <em>input</em> pane has the first line of input from our sample file and the <em>output</em> pane has an XML <strong>record</strong> structure where we have defined a <strong>data</strong> element with the <em>name</em> attribute of <em>bc_software</em> and it&rsquo;s <em>value</em> attribute of <em>SGOS 3.2.4.28</em>. The definition of the <strong>record</strong> structure can be found in the <strong>System/XML Schemas/records</strong> folder.</p>
<p>This is the result of the code in our editor</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xslt" data-lang="xslt"><span style="color:#09f;font-style:italic">&lt;!-- Match the software comment line and save it in _bc_software --&gt;</span>
&lt;<span style="color:#309;font-weight:bold">regex</span> <span style="color:#309">id</span><span style="color:#555">=</span><span style="color:#c30">&#34;software&#34;</span> <span style="color:#309">pattern</span><span style="color:#555">=</span><span style="color:#c30">&#34;^#Software: (.+) ?\n*&#34;</span>&gt;
  &lt;<span style="color:#309;font-weight:bold">data</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;_bc_software&#34;</span> <span style="color:#309">value</span><span style="color:#555">=</span><span style="color:#c30">&#34;$1&#34;</span> /&gt;
&lt;/<span style="color:#309;font-weight:bold">regex</span>&gt;
</code></pre></div><p>If one presses the <img src="../resources/icons/stepForward.png" alt="stepForward" title="Step Forward"> <em>stepping action</em> again, we see that we have moved to the second line of the input file with the resultant output of a <strong>data</strong> element with the <em>name</em> attribute of <em>bc_version</em> and it&rsquo;s <em>value</em> attribute of <em>1.0</em>.</p>
<p><img src="../resources/UI-FeedProcessing-34.png" alt="Stroom UI Create Feed - Translation - Stepping dsParser textConverter 2" title="Stroom UI Create Feed - Translation - Stepping dsParser textConverter 2"></p>
<p>Stepping forward once more causes the translation to ignore the Date comment line, define a Data Splitter $headings variable from the Fields comment line and transform the first line of actual event data.</p>
<p><img src="../resources/UI-FeedProcessing-35.png" alt="Stroom UI Create Feed - Translation - Stepping dsParser textConverter 3" title="Stroom UI Create Feed - Translation - Stepping dsParser textConverter 3"></p>
<p>We see that a <code>&lt;record&gt;</code> element has been formed with multiple key value pair <code>&lt;data&gt;</code> elements where the <em>name</em> attribute is the key and the <em>value</em> attribute the value. You will note that the keys have been taken from the Fields comment line which where placed in the $headings variable.</p>
<p>You should also take note that the <em>stepping indicator</em> has been incrementing the last number, so at this point it is displaying</p>
<pre><code>[1:1:3]
</code></pre>
<p>The general form of this <em>indicator</em> is</p>
<pre><code>'[' streamId ':' subStreamId ':' recordNo ']'
</code></pre>
<p>where</p>
<ul>
<li><strong>streamId</strong> - is the stream ID and won&rsquo;t change when stepping through the selected stream,</li>
<li><strong>subStreamId</strong> - is the sub stream ID. When Stroom aggregates multiple event sources for a feed, it aggregates multiple input files and this is, in effect, the file number.</li>
<li><strong>recordNo</strong> - is the record number within the sub stream.</li>
</ul>
<p>One can double click on either the <strong>subStreamId</strong> or <strong>recordNo</strong> entry and enter a new value. This allows you to <em>jump</em> around a stream rather than just relying on first, previous, next and last movements.</p>
<p>Hovering the mouse over the <em>stepping indicator</em> will change the cursor to a <code>hand pointer</code>. Selecting (by a left click) the <code>recordNo</code> will allow you to edit it&rsquo;s value (and the other values for that matter). You will see the display change from</p>
<p><img src="../resources/UI-FeedProcessing-36.png" alt="Stroom UI Create Feed - Translation - Stepping Indicator 1" title="Stroom UI Create Feed - Translation - Stepping Indicator 1">
to
<img src="../resources/UI-FeedProcessing-37.png" alt="Stroom UI Create Feed - Translation - Stepping Indicator 2" title="Stroom UI Create Feed - Translation - Stepping Indicator 2"></p>
<p>If we change the record number from <strong>3</strong> to <strong>12</strong> then either press Enter or press the <img src="../resources/icons/stepRefresh.png" alt="stepRefresh" title="Refresh Current Step"> action we see</p>
<p><img src="../resources/UI-FeedProcessing-38.png" alt="Stroom UI Create Feed - Translation - Stepping Indicator 3" title="Stroom UI Create Feed - Translation - Stepping Indicator 3"></p>
<p>and note that a new record has been processed in the <em>input</em> and <em>output</em> panes. Further, if one steps back to the <code>Source</code> element of the pipeline to view the raw source file, we see that the highlighted <strong>current</strong> line is the 12th line of processed data. It is the 10th actual bluecoat event, but remember the #Software, #Version lines are considered as processed data  (2+10 = 12). Also noted that the #Date and #Fields lines are not considered processed data, and hence do not contribute to the <strong>recordNo</strong> value.</p>
<p><img src="../resources/UI-FeedProcessing-39.png" alt="Stroom UI Create Feed - Translation - Stepping Indicator 4" title="Stroom UI Create Feed - Translation - Stepping Indicator 4"></p>
<p>If we select the <code>dsParser</code> pipeline element then press the <img src="../resources/icons/stepLast.png" alt="stepLast" title="Step Last"> action we see the <code>recordNo</code> jump to 31 which is the last processed line of our sample log file.</p>
<p><img src="../resources/UI-FeedProcessing-40.png" alt="Stroom UI Create Feed - Translation - Stepping Indicator 5" title="Stroom UI Create Feed - Translation - Stepping Indicator 5"></p>
<h3 id="stepping-the-pipeline---translationfilter">Stepping the Pipeline - translationFilter</h3>
<p>We now select the <code>translationFilter</code> pipeline element that results in</p>
<p><img src="../resources/UI-FeedProcessing-41.png" alt="Stroom UI Create Feed - Translation - Stepping translationFilter Element" title="Stroom UI Create Feed - Translation - Stepping translationFilter Element"></p>
<p>As for the <code>dsParser</code>, this window is made up of four panes.</p>
<p>The top pane remains the same - a display of the pipeline structure and the <em>step indicator</em> and green <em>Stepping Actions</em>.</p>
<p>The next pane down is the editing pane for the Translation Filter. This pane is used to edit an <em>xslt</em> translation that converts our simple key value pair <code>&lt;records&gt;</code> XML structure into another XML form.</p>
<p>The lower two panes are the <em>input</em> and <em>output</em> displays for the xslt translation. You will note that the <em>input</em> and <em>output</em> displays are identical for a null xslt translation is effectively a direct copy.</p>
<p>In this HOWTO we will transform the <code>&lt;records&gt;</code> XML structure into the <em>GCHQ Stroom Event Logging XML Schema</em> form which is documented <a href="https://github.com/gchq/event-logging-schema">here</a>.</p>
<p>The authoring of this xslt translation is outside the scope of this HOWTO, as is the use of the Stroom XML Schema. It is recommended that one reads up on <a href="../../user-guide/pipelines/xslt/README.md">XSLT Conversion</a> and the <a href="https://github.com/gchq/event-logging-schema">Stroom Event Logging XML Schema</a> and review the various samples found in the Stroom Context packs published, or the Pull Requests of <a href="https://github.com/gchq/stroom-content">https://github.com/gchq/stroom-content</a>.</p>
<p>We will build the translation in steps. We enter an initial portion of our xslt transformation that just consumes the <code>Software</code> and <code>Version</code> key values and converts the <code>date</code> and <code>time</code> values (which are in UTC) into the <code>EventTime/TimeCreated</code> element. This code segment is</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xslt" data-lang="xslt"><span style="color:#099">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
&lt;<span style="color:#309;font-weight:bold">xsl:stylesheet</span> <span style="color:#309">xpath-default-namespace</span><span style="color:#555">=</span><span style="color:#c30">&#34;records:2&#34;</span> <span style="color:#309">xmlns</span><span style="color:#555">=</span><span style="color:#c30">&#34;event-logging:3&#34;</span> <span style="color:#309">xmlns:stroom</span><span style="color:#555">=</span><span style="color:#c30">&#34;stroom&#34;</span> 
                <span style="color:#309">xmlns:xsl</span><span style="color:#555">=</span><span style="color:#c30">&#34;http://www.w3.org/1999/XSL/Transform&#34;</span> <span style="color:#309">xmlns:xsi</span><span style="color:#555">=</span><span style="color:#c30">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span style="color:#309">xmlns:xs</span><span style="color:#555">=</span><span style="color:#c30">&#34;http://www.w3.org/2001/XMLSchema&#34;</span> <span style="color:#309">version</span><span style="color:#555">=</span><span style="color:#c30">&#34;3.0&#34;</span>&gt;

  <span style="color:#09f;font-style:italic">&lt;!-- Bluecoat Proxy logs in W2C Extended Log File Format (ELF) --&gt;</span>

  <span style="color:#09f;font-style:italic">&lt;!-- Ingest the record key value pair elements --&gt;</span>
  &lt;<span style="color:#309;font-weight:bold">xsl:template</span> <span style="color:#309">match</span><span style="color:#555">=</span><span style="color:#c30">&#34;records&#34;</span>&gt;
    &lt;<span style="color:#309;font-weight:bold">Events</span> <span style="color:#309">xsi:schemaLocation</span><span style="color:#555">=</span><span style="color:#c30">&#34;event-logging:3 file://event-logging-v3.2.4.xsd&#34;</span> <span style="color:#309">Version</span><span style="color:#555">=</span><span style="color:#c30">&#34;3.2.4&#34;</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:apply-templates</span> /&gt;
    &lt;/<span style="color:#309;font-weight:bold">Events</span>&gt;
  &lt;/<span style="color:#309;font-weight:bold">xsl:template</span>&gt;

  <span style="color:#09f;font-style:italic">&lt;!-- Main record template for single event --&gt;</span>
  &lt;<span style="color:#309;font-weight:bold">xsl:template</span> <span style="color:#309">match</span><span style="color:#555">=</span><span style="color:#c30">&#34;record&#34;</span>&gt;
    &lt;<span style="color:#309;font-weight:bold">xsl:choose</span>&gt;

      <span style="color:#09f;font-style:italic">&lt;!-- Store the Software and Version information of the Bluecoat log file for use in the Event Source elements which are processed later --&gt;</span>
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;_bc_software&#39;]&#34;</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;stroom:put(&#39;_bc_software&#39;, data[@name=&#39;_bc_software&#39;]/@value)&#34;</span> /&gt;
      &lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;_bc_version&#39;]&#34;</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;stroom:put(&#39;_bc_version&#39;, data[@name=&#39;_bc_version&#39;]/@value)&#34;</span> /&gt;
      &lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;

      <span style="color:#09f;font-style:italic">&lt;!-- Process the event logs --&gt;</span>
      &lt;<span style="color:#309;font-weight:bold">xsl:otherwise</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">Event</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:call-template</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;event_time&#34;</span> /&gt;
        &lt;/<span style="color:#309;font-weight:bold">Event</span>&gt;
      &lt;/<span style="color:#309;font-weight:bold">xsl:otherwise</span>&gt;
    &lt;/<span style="color:#309;font-weight:bold">xsl:choose</span>&gt;
  &lt;/<span style="color:#309;font-weight:bold">xsl:template</span>&gt;

  <span style="color:#09f;font-style:italic">&lt;!-- Time --&gt;</span>
  &lt;<span style="color:#309;font-weight:bold">xsl:template</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;event_time&#34;</span>&gt;
    &lt;<span style="color:#309;font-weight:bold">EventTime</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">TimeCreated</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;concat(data[@name = &#39;date&#39;]/@value,&#39;T&#39;,data[@name=&#39;time&#39;]/@value,&#39;.000Z&#39;)&#34;</span> /&gt;
      &lt;/<span style="color:#309;font-weight:bold">TimeCreated</span>&gt;
    &lt;/<span style="color:#309;font-weight:bold">EventTime</span>&gt;
  &lt;/<span style="color:#309;font-weight:bold">xsl:template</span>&gt;
&lt;/<span style="color:#309;font-weight:bold">xsl:stylesheet</span>&gt;
</code></pre></div><p>After entering this translation and pressing the <img src="../resources/icons/stepRefresh.png" alt="stepRefresh" title="Refresh Current Step"> action shows the display</p>
<p><img src="../resources/UI-FeedProcessing-42.png" alt="Stroom UI Create Feed - Translation - Stepping XSLT Translation 1" title="Stroom UI Create Feed - Translation - Stepping XSLT Translation 1"></p>
<p>Note that this is the 31st record, so if we were to jump to the first record using the <img src="../resources/icons/stepFirst.png" alt="stepFirst" title="Step First"> action, we see that the <em>input</em> and <em>output</em> change appropriately.</p>
<p><img src="../resources/UI-FeedProcessing-43.png" alt="Stroom UI Create Feed - Translation - Stepping XSLT Translation 2" title="Stroom UI Create Feed - Translation - Stepping XSLT Translation 2"></p>
<p>You will note that there is no <code>Event</code> element in the <em>output</em> pane as the <em>record</em> template in our xslt translation above is only storing the input&rsquo;s key value (_bc_software&rsquo;s value).</p>
<p>Further note that the <strong>BlueCoat_Proxy-V1.0-EVENTS</strong> tab has a <em>star</em> in front of it and also the <em>Save</em> icon <img src="../resources/icons/save.png" alt="Save" title="Save"> is highlighted. This indicates that a component of the pipeline needs to be saved. In this case, the XSLT translation.</p>
<p><img src="../resources/UI-FeedProcessing-44.png" alt="Stroom UI Create Feed - Translation - Stepping XSLT Translation 3" title="Stroom UI Create Feed - Translation - Stepping XSLT Translation 3"></p>
<p>By pressing the <em>Save</em> icon, you will save the XSLT translation as it currently stands and both the <em>star</em> will be removed from the tab and the <em>Save</em> icon will no longer be highlighted.</p>
<p><img src="../resources/UI-FeedProcessing-45.png" alt="Stroom UI Create Feed - Translation - Stepping XSLT Translation 4" title="Stroom UI Create Feed - Translation - Stepping XSLT Translation 4"></p>
<p>We next extend out translation by authoring a <strong>event_source</strong> template to form an appropriate Stroom Event Logging <code>EventSource</code> element structure. Thus our translation now is</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xslt" data-lang="xslt"><span style="color:#099">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
&lt;<span style="color:#309;font-weight:bold">xsl:stylesheet</span> <span style="color:#309">xpath-default-namespace</span><span style="color:#555">=</span><span style="color:#c30">&#34;records:2&#34;</span> <span style="color:#309">xmlns</span><span style="color:#555">=</span><span style="color:#c30">&#34;event-logging:3&#34;</span> <span style="color:#309">xmlns:stroom</span><span style="color:#555">=</span><span style="color:#c30">&#34;stroom&#34;</span>
                <span style="color:#309">xmlns:xsl</span><span style="color:#555">=</span><span style="color:#c30">&#34;http://www.w3.org/1999/XSL/Transform&#34;</span> <span style="color:#309">xmlns:xsi</span><span style="color:#555">=</span><span style="color:#c30">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span style="color:#309">xmlns:xs</span><span style="color:#555">=</span><span style="color:#c30">&#34;http://www.w3.org/2001/XMLSchema&#34;</span> <span style="color:#309">version</span><span style="color:#555">=</span><span style="color:#c30">&#34;3.0&#34;</span>&gt;

  <span style="color:#09f;font-style:italic">&lt;!-- Bluecoat Proxy logs in W2C Extended Log File Format (ELF) --&gt;</span>

  <span style="color:#09f;font-style:italic">&lt;!-- Ingest the record key value pair elements --&gt;</span>
  &lt;<span style="color:#309;font-weight:bold">xsl:template</span> <span style="color:#309">match</span><span style="color:#555">=</span><span style="color:#c30">&#34;records&#34;</span>&gt;
    &lt;<span style="color:#309;font-weight:bold">Events</span> <span style="color:#309">xsi:schemaLocation</span><span style="color:#555">=</span><span style="color:#c30">&#34;event-logging:3 file://event-logging-v3.2.4.xsd&#34;</span> <span style="color:#309">Version</span><span style="color:#555">=</span><span style="color:#c30">&#34;3.2.4&#34;</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:apply-templates</span> /&gt;
    &lt;/<span style="color:#309;font-weight:bold">Events</span>&gt;
  &lt;/<span style="color:#309;font-weight:bold">xsl:template</span>&gt;

  <span style="color:#09f;font-style:italic">&lt;!-- Main record template for single event --&gt;</span>
  &lt;<span style="color:#309;font-weight:bold">xsl:template</span> <span style="color:#309">match</span><span style="color:#555">=</span><span style="color:#c30">&#34;record&#34;</span>&gt;
    &lt;<span style="color:#309;font-weight:bold">xsl:choose</span>&gt;

      <span style="color:#09f;font-style:italic">&lt;!-- Store the Software and Version information of the Bluecoat log file for use in the Event Source elements which are processed later --&gt;</span>
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;_bc_software&#39;]&#34;</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;stroom:put(&#39;_bc_software&#39;, data[@name=&#39;_bc_software&#39;]/@value)&#34;</span> /&gt;
      &lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;_bc_version&#39;]&#34;</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;stroom:put(&#39;_bc_version&#39;, data[@name=&#39;_bc_version&#39;]/@value)&#34;</span> /&gt;
      &lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;

      <span style="color:#09f;font-style:italic">&lt;!-- Process the event logs --&gt;</span>
      &lt;<span style="color:#309;font-weight:bold">xsl:otherwise</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">Event</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:call-template</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;event_time&#34;</span> /&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:call-template</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;event_source&#34;</span> /&gt;
        &lt;/<span style="color:#309;font-weight:bold">Event</span>&gt;
      &lt;/<span style="color:#309;font-weight:bold">xsl:otherwise</span>&gt;
    &lt;/<span style="color:#309;font-weight:bold">xsl:choose</span>&gt;
  &lt;/<span style="color:#309;font-weight:bold">xsl:template</span>&gt;

  <span style="color:#09f;font-style:italic">&lt;!-- Time --&gt;</span>
  &lt;<span style="color:#309;font-weight:bold">xsl:template</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;event_time&#34;</span>&gt;
    &lt;<span style="color:#309;font-weight:bold">EventTime</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">TimeCreated</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;concat(data[@name = &#39;date&#39;]/@value,&#39;T&#39;,data[@name=&#39;time&#39;]/@value,&#39;.000Z&#39;)&#34;</span> /&gt;
      &lt;/<span style="color:#309;font-weight:bold">TimeCreated</span>&gt;
    &lt;/<span style="color:#309;font-weight:bold">EventTime</span>&gt;
  &lt;/<span style="color:#309;font-weight:bold">xsl:template</span>&gt;

  <span style="color:#09f;font-style:italic">&lt;!-- Template for event source--&gt;</span>
  &lt;<span style="color:#309;font-weight:bold">xsl:template</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;event_source&#34;</span>&gt;

    <span style="color:#09f;font-style:italic">&lt;!--
</span><span style="color:#09f;font-style:italic">    We extract some situational awareness information that the posting script includes when posting the event data 
</span><span style="color:#09f;font-style:italic">    --&gt;</span>
    &lt;<span style="color:#309;font-weight:bold">xsl:variable</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;_mymeta&#34;</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;translate(stroom:meta(&#39;MyMeta&#39;),&#39;&amp;quot;&#39;, &#39;&#39;)&#34;</span> /&gt;

    <span style="color:#09f;font-style:italic">&lt;!-- Form the EventSource node --&gt;</span>
    &lt;<span style="color:#309;font-weight:bold">EventSource</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">System</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">Name</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;stroom:meta(&#39;System&#39;)&#34;</span> /&gt;
        &lt;/<span style="color:#309;font-weight:bold">Name</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">Environment</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;stroom:meta(&#39;Environment&#39;)&#34;</span> /&gt;
        &lt;/<span style="color:#309;font-weight:bold">Environment</span>&gt;
      &lt;/<span style="color:#309;font-weight:bold">System</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">Generator</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:variable</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;gen&#34;</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;stroom:get(&#39;_bc_software&#39;)&#34;</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;concat(&#39; Software: &#39;, stroom:get(&#39;_bc_software&#39;))&#34;</span> /&gt;
          &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;stroom:get(&#39;_bc_version&#39;)&#34;</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;concat(&#39; Version: &#39;, stroom:get(&#39;_bc_version&#39;))&#34;</span> /&gt;
          &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">xsl:variable</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;concat(&#39;Bluecoat&#39;, $gen)&#34;</span> /&gt;
      &lt;/<span style="color:#309;font-weight:bold">Generator</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;s-computername&#39;] or data[@name=&#39;s-ip&#39;]&#34;</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">Device</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;s-computername&#39;]&#34;</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">Name</span>&gt;
              &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;s-computername&#39;]/@value&#34;</span> /&gt;
            &lt;/<span style="color:#309;font-weight:bold">Name</span>&gt;
          &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;s-ip&#39;]&#34;</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">IPAddress</span>&gt;
              &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34; data[@name=&#39;s-ip&#39;]/@value&#34;</span> /&gt;
            &lt;/<span style="color:#309;font-weight:bold">IPAddress</span>&gt;
          &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;s-sitename&#39;]&#34;</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">Data</span> <span style="color:#309">Name</span><span style="color:#555">=</span><span style="color:#c30">&#34;ServiceType&#34;</span> <span style="color:#309">Value</span><span style="color:#555">=</span><span style="color:#c30">&#34;{data[@name=&#39;s-sitename&#39;]/@value}&#34;</span> /&gt;
          &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">Device</span>&gt;
      &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;

      <span style="color:#09f;font-style:italic">&lt;!-- --&gt;</span>
      &lt;<span style="color:#309;font-weight:bold">Client</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;c-ip&#39;]/@value != &#39;-&#39;&#34;</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">IPAddress</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;c-ip&#39;]/@value&#34;</span> /&gt;
          &lt;/<span style="color:#309;font-weight:bold">IPAddress</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;

        <span style="color:#09f;font-style:italic">&lt;!-- Remote Port Number --&gt;</span>
        &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;c-port&#39;]/@value !=&#39;-&#39;&#34;</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">Port</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;c-port&#39;]/@value&#34;</span> /&gt;
          &lt;/<span style="color:#309;font-weight:bold">Port</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;
      &lt;/<span style="color:#309;font-weight:bold">Client</span>&gt;

      <span style="color:#09f;font-style:italic">&lt;!-- --&gt;</span>
      &lt;<span style="color:#309;font-weight:bold">Server</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">HostName</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-host&#39;]/@value&#34;</span> /&gt;
        &lt;/<span style="color:#309;font-weight:bold">HostName</span>&gt;
      &lt;/<span style="color:#309;font-weight:bold">Server</span>&gt;

      <span style="color:#09f;font-style:italic">&lt;!-- --&gt;</span>
      &lt;<span style="color:#309;font-weight:bold">xsl:variable</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;user&#34;</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-user&#39;]/@value&#34;</span> /&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-username&#39;]/@value&#34;</span> /&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-userdn&#39;]/@value&#34;</span> /&gt;
      &lt;/<span style="color:#309;font-weight:bold">xsl:variable</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$user !=&#39;-&#39;&#34;</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">User</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">Id</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;$user&#34;</span> /&gt;
          &lt;/<span style="color:#309;font-weight:bold">Id</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">User</span>&gt;
      &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">Data</span> <span style="color:#309">Name</span><span style="color:#555">=</span><span style="color:#c30">&#34;MyMeta&#34;</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:attribute</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;Value&#34;</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;$_mymeta&#34;</span> /&gt;
      &lt;/<span style="color:#309;font-weight:bold">Data</span>&gt;
    &lt;/<span style="color:#309;font-weight:bold">EventSource</span>&gt;
  &lt;/<span style="color:#309;font-weight:bold">xsl:template</span>&gt;
&lt;/<span style="color:#309;font-weight:bold">xsl:stylesheet</span>&gt;
</code></pre></div><p>Stepping to the 3 record (the first real data record in our sample log) will reveal that our <em>output</em> pane has gained an <code>EventSource</code> element.</p>
<p><img src="../resources/UI-FeedProcessing-46.png" alt="Stroom UI Create Feed - Translation - Stepping XSLT Translation 5" title="Stroom UI Create Feed - Translation - Stepping XSLT Translation 5"></p>
<p>Note also, that our <em>Save</em> icon <img src="../resources/icons/save.png" alt="Save" title="Save"> is also highlighted, so we should at some point save the extensions to our translation.</p>
<p>The complete translation now follows. A copy of the XSLT translation can be found <a href="BlueCoat.xslt" title="BlueCoat XSLT Translation">here</a>.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xslt" data-lang="xslt"><span style="color:#099">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
&lt;<span style="color:#309;font-weight:bold">xsl:stylesheet</span> <span style="color:#309">xpath-default-namespace</span><span style="color:#555">=</span><span style="color:#c30">&#34;records:2&#34;</span> <span style="color:#309">xmlns</span><span style="color:#555">=</span><span style="color:#c30">&#34;event-logging:3&#34;</span> <span style="color:#309">xmlns:stroom</span><span style="color:#555">=</span><span style="color:#c30">&#34;stroom&#34;</span> 
                <span style="color:#309">xmlns:xsl</span><span style="color:#555">=</span><span style="color:#c30">&#34;http://www.w3.org/1999/XSL/Transform&#34;</span> <span style="color:#309">xmlns:xsi</span><span style="color:#555">=</span><span style="color:#c30">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span style="color:#309">xmlns:xs</span><span style="color:#555">=</span><span style="color:#c30">&#34;http://www.w3.org/2001/XMLSchema&#34;</span> <span style="color:#309">version</span><span style="color:#555">=</span><span style="color:#c30">&#34;3.0&#34;</span>&gt;

  <span style="color:#09f;font-style:italic">&lt;!-- Bluecoat Proxy logs in W2C Extended Log File Format (ELF) --&gt;</span>

  <span style="color:#09f;font-style:italic">&lt;!-- Ingest the record key value pair elements --&gt;</span>
  &lt;<span style="color:#309;font-weight:bold">xsl:template</span> <span style="color:#309">match</span><span style="color:#555">=</span><span style="color:#c30">&#34;records&#34;</span>&gt;
    &lt;<span style="color:#309;font-weight:bold">Events</span> <span style="color:#309">xsi:schemaLocation</span><span style="color:#555">=</span><span style="color:#c30">&#34;event-logging:3 file://event-logging-v3.2.4.xsd&#34;</span> <span style="color:#309">Version</span><span style="color:#555">=</span><span style="color:#c30">&#34;3.2.4&#34;</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:apply-templates</span> /&gt;
    &lt;/<span style="color:#309;font-weight:bold">Events</span>&gt;
  &lt;/<span style="color:#309;font-weight:bold">xsl:template</span>&gt;

  <span style="color:#09f;font-style:italic">&lt;!-- Main record template for single event --&gt;</span>
  &lt;<span style="color:#309;font-weight:bold">xsl:template</span> <span style="color:#309">match</span><span style="color:#555">=</span><span style="color:#c30">&#34;record&#34;</span>&gt;
    &lt;<span style="color:#309;font-weight:bold">xsl:choose</span>&gt;

      <span style="color:#09f;font-style:italic">&lt;!-- Store the Software and Version information of the Bluecoat log file for use in the Event Source elements which are processed later --&gt;</span>
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;_bc_software&#39;]&#34;</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;stroom:put(&#39;_bc_software&#39;, data[@name=&#39;_bc_software&#39;]/@value)&#34;</span> /&gt;
      &lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;_bc_version&#39;]&#34;</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;stroom:put(&#39;_bc_version&#39;, data[@name=&#39;_bc_version&#39;]/@value)&#34;</span> /&gt;
      &lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;

      <span style="color:#09f;font-style:italic">&lt;!-- Process the event logs --&gt;</span>
      &lt;<span style="color:#309;font-weight:bold">xsl:otherwise</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">Event</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:call-template</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;event_time&#34;</span> /&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:call-template</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;event_source&#34;</span> /&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:call-template</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;event_detail&#34;</span> /&gt;
        &lt;/<span style="color:#309;font-weight:bold">Event</span>&gt;
      &lt;/<span style="color:#309;font-weight:bold">xsl:otherwise</span>&gt;
    &lt;/<span style="color:#309;font-weight:bold">xsl:choose</span>&gt;
  &lt;/<span style="color:#309;font-weight:bold">xsl:template</span>&gt;

  <span style="color:#09f;font-style:italic">&lt;!-- Time --&gt;</span>
  &lt;<span style="color:#309;font-weight:bold">xsl:template</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;event_time&#34;</span>&gt;
    &lt;<span style="color:#309;font-weight:bold">EventTime</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">TimeCreated</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;concat(data[@name = &#39;date&#39;]/@value,&#39;T&#39;,data[@name=&#39;time&#39;]/@value,&#39;.000Z&#39;)&#34;</span> /&gt;
      &lt;/<span style="color:#309;font-weight:bold">TimeCreated</span>&gt;
    &lt;/<span style="color:#309;font-weight:bold">EventTime</span>&gt;
  &lt;/<span style="color:#309;font-weight:bold">xsl:template</span>&gt;

  <span style="color:#09f;font-style:italic">&lt;!-- Template for event source--&gt;</span>
  &lt;<span style="color:#309;font-weight:bold">xsl:template</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;event_source&#34;</span>&gt;

    <span style="color:#09f;font-style:italic">&lt;!--
</span><span style="color:#09f;font-style:italic">    We extract some situational awareness information that the posting script includes when posting the event data 
</span><span style="color:#09f;font-style:italic">    --&gt;</span>
    &lt;<span style="color:#309;font-weight:bold">xsl:variable</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;_mymeta&#34;</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;translate(stroom:meta(&#39;MyMeta&#39;),&#39;&amp;quot;&#39;, &#39;&#39;)&#34;</span> /&gt;

    <span style="color:#09f;font-style:italic">&lt;!-- Form the EventSource node --&gt;</span>
    &lt;<span style="color:#309;font-weight:bold">EventSource</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">System</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">Name</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;stroom:meta(&#39;System&#39;)&#34;</span> /&gt;
        &lt;/<span style="color:#309;font-weight:bold">Name</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">Environment</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;stroom:meta(&#39;Environment&#39;)&#34;</span> /&gt;
        &lt;/<span style="color:#309;font-weight:bold">Environment</span>&gt;
      &lt;/<span style="color:#309;font-weight:bold">System</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">Generator</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:variable</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;gen&#34;</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;stroom:get(&#39;_bc_software&#39;)&#34;</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;concat(&#39; Software: &#39;, stroom:get(&#39;_bc_software&#39;))&#34;</span> /&gt;
          &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;stroom:get(&#39;_bc_version&#39;)&#34;</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;concat(&#39; Version: &#39;, stroom:get(&#39;_bc_version&#39;))&#34;</span> /&gt;
          &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">xsl:variable</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;concat(&#39;Bluecoat&#39;, $gen)&#34;</span> /&gt;
      &lt;/<span style="color:#309;font-weight:bold">Generator</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;s-computername&#39;] or data[@name=&#39;s-ip&#39;]&#34;</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">Device</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;s-computername&#39;]&#34;</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">Name</span>&gt;
              &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;s-computername&#39;]/@value&#34;</span> /&gt;
            &lt;/<span style="color:#309;font-weight:bold">Name</span>&gt;
          &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;s-ip&#39;]&#34;</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">IPAddress</span>&gt;
              &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34; data[@name=&#39;s-ip&#39;]/@value&#34;</span> /&gt;
            &lt;/<span style="color:#309;font-weight:bold">IPAddress</span>&gt;
          &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;s-sitename&#39;]&#34;</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">Data</span> <span style="color:#309">Name</span><span style="color:#555">=</span><span style="color:#c30">&#34;ServiceType&#34;</span> <span style="color:#309">Value</span><span style="color:#555">=</span><span style="color:#c30">&#34;{data[@name=&#39;s-sitename&#39;]/@value}&#34;</span> /&gt;
          &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">Device</span>&gt;
      &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;

      <span style="color:#09f;font-style:italic">&lt;!-- --&gt;</span>
      &lt;<span style="color:#309;font-weight:bold">Client</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;c-ip&#39;]/@value != &#39;-&#39;&#34;</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">IPAddress</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;c-ip&#39;]/@value&#34;</span> /&gt;
          &lt;/<span style="color:#309;font-weight:bold">IPAddress</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;

        <span style="color:#09f;font-style:italic">&lt;!-- Remote Port Number --&gt;</span>
        &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;c-port&#39;]/@value !=&#39;-&#39;&#34;</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">Port</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;c-port&#39;]/@value&#34;</span> /&gt;
          &lt;/<span style="color:#309;font-weight:bold">Port</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;
      &lt;/<span style="color:#309;font-weight:bold">Client</span>&gt;

      <span style="color:#09f;font-style:italic">&lt;!-- --&gt;</span>
      &lt;<span style="color:#309;font-weight:bold">Server</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">HostName</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-host&#39;]/@value&#34;</span> /&gt;
        &lt;/<span style="color:#309;font-weight:bold">HostName</span>&gt;
      &lt;/<span style="color:#309;font-weight:bold">Server</span>&gt;

      <span style="color:#09f;font-style:italic">&lt;!-- --&gt;</span>
      &lt;<span style="color:#309;font-weight:bold">xsl:variable</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;user&#34;</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-user&#39;]/@value&#34;</span> /&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-username&#39;]/@value&#34;</span> /&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-userdn&#39;]/@value&#34;</span> /&gt;
      &lt;/<span style="color:#309;font-weight:bold">xsl:variable</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$user !=&#39;-&#39;&#34;</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">User</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">Id</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;$user&#34;</span> /&gt;
          &lt;/<span style="color:#309;font-weight:bold">Id</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">User</span>&gt;
      &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">Data</span> <span style="color:#309">Name</span><span style="color:#555">=</span><span style="color:#c30">&#34;MyMeta&#34;</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:attribute</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;Value&#34;</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;$_mymeta&#34;</span> /&gt;
      &lt;/<span style="color:#309;font-weight:bold">Data</span>&gt;
    &lt;/<span style="color:#309;font-weight:bold">EventSource</span>&gt;
  &lt;/<span style="color:#309;font-weight:bold">xsl:template</span>&gt;

  <span style="color:#09f;font-style:italic">&lt;!-- Event detail --&gt;</span>
  &lt;<span style="color:#309;font-weight:bold">xsl:template</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;event_detail&#34;</span>&gt;
    &lt;<span style="color:#309;font-weight:bold">EventDetail</span>&gt;

      <span style="color:#09f;font-style:italic">&lt;!--
</span><span style="color:#09f;font-style:italic">      We model Proxy events as either Receive or Send events depending on the method.
</span><span style="color:#09f;font-style:italic">      
</span><span style="color:#09f;font-style:italic">      We make use of the Receive/Send sub-elements Source/Destination to map the Client/Destination Proxy values
</span><span style="color:#09f;font-style:italic">      and the Payload sub-element to map the URL and other details of the activity. If we have a query, we model it
</span><span style="color:#09f;font-style:italic">      as a Criteria
</span><span style="color:#09f;font-style:italic">      
</span><span style="color:#09f;font-style:italic">      --&gt;</span>
      &lt;<span style="color:#309;font-weight:bold">TypeId</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;concat(&#39;Bluecoat-&#39;, data[@name=&#39;cs-method&#39;]/@value, &#39;-&#39;, data[@name=&#39;cs-uri-scheme&#39;]/@value)&#34;</span> /&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-uri-query&#39;]/@value != &#39;-&#39;&#34;</span>&gt;-Query&lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;
      &lt;/<span style="color:#309;font-weight:bold">TypeId</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:choose</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;matches(data[@name=&#39;cs-method&#39;]/@value, &#39;GET|OPTIONS|HEAD&#39;)&#34;</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">Description</span>&gt;Receipt of information from a Resource via Proxy&lt;/<span style="color:#309;font-weight:bold">Description</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">Receive</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:call-template</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;setupParticipants&#34;</span> /&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:call-template</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;setPayload&#34;</span> /&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:call-template</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;setOutcome&#34;</span> /&gt;
          &lt;/<span style="color:#309;font-weight:bold">Receive</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:otherwise</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">Description</span>&gt;Transmission of information to a Resource via Proxy&lt;/<span style="color:#309;font-weight:bold">Description</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">Send</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:call-template</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;setupParticipants&#34;</span> /&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:call-template</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;setPayload&#34;</span> /&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:call-template</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;setOutcome&#34;</span> /&gt;
          &lt;/<span style="color:#309;font-weight:bold">Send</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">xsl:otherwise</span>&gt;
      &lt;/<span style="color:#309;font-weight:bold">xsl:choose</span>&gt;
    &lt;/<span style="color:#309;font-weight:bold">EventDetail</span>&gt;
  &lt;/<span style="color:#309;font-weight:bold">xsl:template</span>&gt;

  <span style="color:#09f;font-style:italic">&lt;!-- Establish the Source and Destination nodes --&gt;</span>
  &lt;<span style="color:#309;font-weight:bold">xsl:template</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;setupParticipants&#34;</span>&gt;
    &lt;<span style="color:#309;font-weight:bold">Source</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">Device</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;c-ip&#39;]/@value != &#39;-&#39;&#34;</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">IPAddress</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;c-ip&#39;]/@value&#34;</span> /&gt;
          &lt;/<span style="color:#309;font-weight:bold">IPAddress</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;

        <span style="color:#09f;font-style:italic">&lt;!-- Remote Port Number --&gt;</span>
        &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;c-port&#39;]/@value !=&#39;-&#39;&#34;</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">Port</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;c-port&#39;]/@value&#34;</span> /&gt;
          &lt;/<span style="color:#309;font-weight:bold">Port</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;
      &lt;/<span style="color:#309;font-weight:bold">Device</span>&gt;
    &lt;/<span style="color:#309;font-weight:bold">Source</span>&gt;
    &lt;<span style="color:#309;font-weight:bold">Destination</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">Device</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">HostName</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-host&#39;]/@value&#34;</span> /&gt;
        &lt;/<span style="color:#309;font-weight:bold">HostName</span>&gt;
      &lt;/<span style="color:#309;font-weight:bold">Device</span>&gt;
    &lt;/<span style="color:#309;font-weight:bold">Destination</span>&gt;
  &lt;/<span style="color:#309;font-weight:bold">xsl:template</span>&gt;

  <span style="color:#09f;font-style:italic">&lt;!-- Define the Payload node --&gt;</span>
  &lt;<span style="color:#309;font-weight:bold">xsl:template</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;setPayload&#34;</span>&gt;
    &lt;<span style="color:#309;font-weight:bold">Payload</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-uri-query&#39;]/@value != &#39;-&#39;&#34;</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">Criteria</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">DataSources</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">DataSource</span>&gt;
              &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;concat(data[@name=&#39;cs-uri-scheme&#39;]/@value, &#39;://&#39;, data[@name=&#39;cs-host&#39;]/@value)&#34;</span> /&gt;
              &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-uri-path&#39;]/@value != &#39;/&#39;&#34;</span>&gt;
                &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-uri-path&#39;]/@value&#34;</span> /&gt;
              &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;
            &lt;/<span style="color:#309;font-weight:bold">DataSource</span>&gt;
          &lt;/<span style="color:#309;font-weight:bold">DataSources</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">Query</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">Raw</span>&gt;
              &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-uri-query&#39;]/@value&#34;</span> /&gt;
            &lt;/<span style="color:#309;font-weight:bold">Raw</span>&gt;
          &lt;/<span style="color:#309;font-weight:bold">Query</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">Criteria</span>&gt;
      &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">Resource</span>&gt;

        <span style="color:#09f;font-style:italic">&lt;!-- Check for auth groups the URL belongs to --&gt;</span>
        &lt;<span style="color:#309;font-weight:bold">xsl:variable</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;authgroups&#34;</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-auth-group&#39;]/@value&#34;</span> /&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;exists(data[@name=&#39;cs-auth-group&#39;]) and exists(data[@name=&#39;cs-auth-groups&#39;])&#34;</span>&gt;,&lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-auth-groups&#39;]/@value&#34;</span> /&gt;
        &lt;/<span style="color:#309;font-weight:bold">xsl:variable</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:choose</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;contains($authgroups, &#39;,&#39;)&#34;</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">Groups</span>&gt;
              &lt;<span style="color:#309;font-weight:bold">xsl:for-each</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;tokenize($authgroups, &#39;,&#39;)&#34;</span>&gt;
                &lt;<span style="color:#309;font-weight:bold">Group</span>&gt;
                  &lt;<span style="color:#309;font-weight:bold">Id</span>&gt;
                    &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;.&#34;</span> /&gt;
                  &lt;/<span style="color:#309;font-weight:bold">Id</span>&gt;
                &lt;/<span style="color:#309;font-weight:bold">Group</span>&gt;
              &lt;/<span style="color:#309;font-weight:bold">xsl:for-each</span>&gt;
            &lt;/<span style="color:#309;font-weight:bold">Groups</span>&gt;
          &lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$authgroups != &#39;-&#39; and $authgroups != &#39;&#39;&#34;</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">Groups</span>&gt;
              &lt;<span style="color:#309;font-weight:bold">Group</span>&gt;
                &lt;<span style="color:#309;font-weight:bold">Id</span>&gt;
                  &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;$authgroups&#34;</span> /&gt;
                &lt;/<span style="color:#309;font-weight:bold">Id</span>&gt;
              &lt;/<span style="color:#309;font-weight:bold">Group</span>&gt;
            &lt;/<span style="color:#309;font-weight:bold">Groups</span>&gt;
          &lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">xsl:choose</span>&gt;

        <span style="color:#09f;font-style:italic">&lt;!-- Re-form the URL --&gt;</span>
        &lt;<span style="color:#309;font-weight:bold">URL</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;concat(data[@name=&#39;cs-uri-scheme&#39;]/@value, &#39;://&#39;, data[@name=&#39;cs-host&#39;]/@value)&#34;</span> /&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-uri-path&#39;]/@value != &#39;/&#39;&#34;</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-uri-path&#39;]/@value&#34;</span> /&gt;
          &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">URL</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">HTTPMethod</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-method&#39;]/@value&#34;</span> /&gt;
        &lt;/<span style="color:#309;font-weight:bold">HTTPMethod</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs(User-Agent)&#39;]/@value !=&#39;-&#39;&#34;</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">UserAgent</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs(User-Agent)&#39;]/@value&#34;</span> /&gt;
          &lt;/<span style="color:#309;font-weight:bold">UserAgent</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;

        <span style="color:#09f;font-style:italic">&lt;!-- Inbound activity --&gt;</span>
        &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;sc-bytes&#39;]/@value !=&#39;-&#39;&#34;</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">InboundSize</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;sc-bytes&#39;]/@value&#34;</span> /&gt;
          &lt;/<span style="color:#309;font-weight:bold">InboundSize</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;sc-bodylength&#39;]/@value !=&#39;-&#39;&#34;</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">InboundContentSize</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;sc-bodylength&#39;]/@value&#34;</span> /&gt;
          &lt;/<span style="color:#309;font-weight:bold">InboundContentSize</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;

        <span style="color:#09f;font-style:italic">&lt;!-- Outbound activity --&gt;</span>
        &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-bytes&#39;]/@value !=&#39;-&#39;&#34;</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">OutboundSize</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-bytes&#39;]/@value&#34;</span> /&gt;
          &lt;/<span style="color:#309;font-weight:bold">OutboundSize</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-bodylength&#39;]/@value !=&#39;-&#39;&#34;</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">OutboundContentSize</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-bodylength&#39;]/@value&#34;</span> /&gt;
          &lt;/<span style="color:#309;font-weight:bold">OutboundContentSize</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;

        <span style="color:#09f;font-style:italic">&lt;!-- Miscellaneous --&gt;</span>
        &lt;<span style="color:#309;font-weight:bold">RequestTime</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;time-taken&#39;]/@value&#34;</span> /&gt;
        &lt;/<span style="color:#309;font-weight:bold">RequestTime</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">ResponseCode</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;sc-status&#39;]/@value&#34;</span> /&gt;
        &lt;/<span style="color:#309;font-weight:bold">ResponseCode</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;rs(Content-Type)&#39;]/@value != &#39;-&#39;&#34;</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">MimeType</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;rs(Content-Type)&#39;]/@value&#34;</span> /&gt;
          &lt;/<span style="color:#309;font-weight:bold">MimeType</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-categories&#39;]/@value != &#39;none&#39; or data[@name=&#39;sc-filter-category&#39;]/@value != &#39;none&#39;&#34;</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">Category</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-categories&#39;]/@value&#34;</span> /&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;sc-filter-category&#39;]/@value&#34;</span> /&gt;
          &lt;/<span style="color:#309;font-weight:bold">Category</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;

        <span style="color:#09f;font-style:italic">&lt;!-- Take up other items as data elements --&gt;</span>
        &lt;<span style="color:#309;font-weight:bold">xsl:apply-templates</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;s-action&#39;]&#34;</span> /&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:apply-templates</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;cs-uri-scheme&#39;]&#34;</span> /&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:apply-templates</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;s-hierarchy&#39;]&#34;</span> /&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:apply-templates</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;sc-filter-result&#39;]&#34;</span> /&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:apply-templates</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;x-virus-id&#39;]&#34;</span> /&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:apply-templates</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;x-virus-details&#39;]&#34;</span> /&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:apply-templates</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;x-icap-error-code&#39;]&#34;</span> /&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:apply-templates</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;x-icap-error-details&#39;]&#34;</span> /&gt;
      &lt;/<span style="color:#309;font-weight:bold">Resource</span>&gt;
    &lt;/<span style="color:#309;font-weight:bold">Payload</span>&gt;
  &lt;/<span style="color:#309;font-weight:bold">xsl:template</span>&gt;

  <span style="color:#09f;font-style:italic">&lt;!-- Generic Data capture template so we capture all other Bluecoat objects not already consumed --&gt;</span>
  &lt;<span style="color:#309;font-weight:bold">xsl:template</span> <span style="color:#309">match</span><span style="color:#555">=</span><span style="color:#c30">&#34;data&#34;</span>&gt;
    &lt;<span style="color:#309;font-weight:bold">xsl:if</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;@value != &#39;-&#39;&#34;</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">Data</span> <span style="color:#309">Name</span><span style="color:#555">=</span><span style="color:#c30">&#34;{@name}&#34;</span> <span style="color:#309">Value</span><span style="color:#555">=</span><span style="color:#c30">&#34;{@value}&#34;</span> /&gt;
    &lt;/<span style="color:#309;font-weight:bold">xsl:if</span>&gt;
  &lt;/<span style="color:#309;font-weight:bold">xsl:template</span>&gt;

  <span style="color:#09f;font-style:italic">&lt;!-- 
</span><span style="color:#09f;font-style:italic">  Set up the Outcome node.
</span><span style="color:#09f;font-style:italic">  
</span><span style="color:#09f;font-style:italic">  We only set an Outcome for an error state. The absence of an Outcome infers success
</span><span style="color:#09f;font-style:italic">  --&gt;</span>
  &lt;<span style="color:#309;font-weight:bold">xsl:template</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;setOutcome&#34;</span>&gt;
    &lt;<span style="color:#309;font-weight:bold">xsl:choose</span>&gt;

      <span style="color:#09f;font-style:italic">&lt;!-- Favour squid specific errors first --&gt;</span>
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;sc-status&#39;]/@value &gt; 500&#34;</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">Outcome</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">Success</span>&gt;false&lt;/<span style="color:#309;font-weight:bold">Success</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">Description</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:call-template</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;responseCodeDesc&#34;</span>&gt;
              &lt;<span style="color:#309;font-weight:bold">xsl:with-param</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;code&#34;</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;sc-status&#39;]/@value&#34;</span> /&gt;
            &lt;/<span style="color:#309;font-weight:bold">xsl:call-template</span>&gt;
          &lt;/<span style="color:#309;font-weight:bold">Description</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">Outcome</span>&gt;
      &lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;

      <span style="color:#09f;font-style:italic">&lt;!-- Now check for &#39;normal&#39; errors --&gt;</span>
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;sc-status&#39;]/@value &gt; 400&#34;</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">Outcome</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">Success</span>&gt;false&lt;/<span style="color:#309;font-weight:bold">Success</span>&gt;
          &lt;<span style="color:#309;font-weight:bold">Description</span>&gt;
            &lt;<span style="color:#309;font-weight:bold">xsl:call-template</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;responseCodeDesc&#34;</span>&gt;
              &lt;<span style="color:#309;font-weight:bold">xsl:with-param</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;code&#34;</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;data[@name=&#39;sc-status&#39;]/@value&#34;</span> /&gt;
            &lt;/<span style="color:#309;font-weight:bold">xsl:call-template</span>&gt;
          &lt;/<span style="color:#309;font-weight:bold">Description</span>&gt;
        &lt;/<span style="color:#309;font-weight:bold">Outcome</span>&gt;
      &lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
    &lt;/<span style="color:#309;font-weight:bold">xsl:choose</span>&gt;
  &lt;/<span style="color:#309;font-weight:bold">xsl:template</span>&gt;

  <span style="color:#09f;font-style:italic">&lt;!-- Response Code map to Descriptions --&gt;</span>
  &lt;<span style="color:#309;font-weight:bold">xsl:template</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;responseCodeDesc&#34;</span>&gt;
    &lt;<span style="color:#309;font-weight:bold">xsl:param</span> <span style="color:#309">name</span><span style="color:#555">=</span><span style="color:#c30">&#34;code&#34;</span> /&gt;
    &lt;<span style="color:#309;font-weight:bold">xsl:choose</span>&gt;

      <span style="color:#09f;font-style:italic">&lt;!-- Informational --&gt;</span>
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 100&#34;</span>&gt;Continue&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 101&#34;</span>&gt;Switching Protocols&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 102&#34;</span>&gt;Processing&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;

      <span style="color:#09f;font-style:italic">&lt;!-- Successful Transaction --&gt;</span>
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 200&#34;</span>&gt;OK&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 201&#34;</span>&gt;Created&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 202&#34;</span>&gt;Accepted&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 203&#34;</span>&gt;Non-Authoritative Information&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 204&#34;</span>&gt;No Content&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 205&#34;</span>&gt;Reset Content&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 206&#34;</span>&gt;Partial Content&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 207&#34;</span>&gt;Multi Status&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;

      <span style="color:#09f;font-style:italic">&lt;!-- Redirection --&gt;</span>
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 300&#34;</span>&gt;Multiple Choices&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 301&#34;</span>&gt;Moved Permanently&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 302&#34;</span>&gt;Moved Temporarily&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 303&#34;</span>&gt;See Other&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 304&#34;</span>&gt;Not Modified&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 305&#34;</span>&gt;Use Proxy&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 307&#34;</span>&gt;Temporary Redirect&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;

      <span style="color:#09f;font-style:italic">&lt;!-- Client Error --&gt;</span>
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 400&#34;</span>&gt;Bad Request&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 401&#34;</span>&gt;Unauthorized&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 402&#34;</span>&gt;Payment Required&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 403&#34;</span>&gt;Forbidden&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 404&#34;</span>&gt;Not Found&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 405&#34;</span>&gt;Method Not Allowed&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 406&#34;</span>&gt;Not Acceptable&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 407&#34;</span>&gt;Proxy Authentication Required&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 408&#34;</span>&gt;Request Timeout&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 409&#34;</span>&gt;Conflict&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 410&#34;</span>&gt;Gone&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 411&#34;</span>&gt;Length Required&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 412&#34;</span>&gt;Precondition Failed&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 413&#34;</span>&gt;Request Entity Too Large&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 414&#34;</span>&gt;Request URI Too Large&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 415&#34;</span>&gt;Unsupported Media Type&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 416&#34;</span>&gt;Request Range Not Satisfiable&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 417&#34;</span>&gt;Expectation Failed&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 422&#34;</span>&gt;Unprocessable Entity&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 424&#34;</span>&gt;Locked/Failed Dependency&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 433&#34;</span>&gt;Unprocessable Entity&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;

      <span style="color:#09f;font-style:italic">&lt;!-- Server Error --&gt;</span>
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 500&#34;</span>&gt;Internal Server Error&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 501&#34;</span>&gt;Not Implemented&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 502&#34;</span>&gt;Bad Gateway&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 503&#34;</span>&gt;Service Unavailable&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 504&#34;</span>&gt;Gateway Timeout&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 505&#34;</span>&gt;HTTP Version Not Supported&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 507&#34;</span>&gt;Insufficient Storage&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 600&#34;</span>&gt;Squid: header parsing error&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 601&#34;</span>&gt;Squid: header size overflow detected while parsing/roundcube: software configuration error&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:when</span> <span style="color:#309">test</span><span style="color:#555">=</span><span style="color:#c30">&#34;$code = 603&#34;</span>&gt;roundcube: invalid authorization&lt;/<span style="color:#309;font-weight:bold">xsl:when</span>&gt;
      &lt;<span style="color:#309;font-weight:bold">xsl:otherwise</span>&gt;
        &lt;<span style="color:#309;font-weight:bold">xsl:value-of</span> <span style="color:#309">select</span><span style="color:#555">=</span><span style="color:#c30">&#34;concat(&#39;Unknown Code:&#39;, $code)&#34;</span> /&gt;
      &lt;/<span style="color:#309;font-weight:bold">xsl:otherwise</span>&gt;
    &lt;/<span style="color:#309;font-weight:bold">xsl:choose</span>&gt;
  &lt;/<span style="color:#309;font-weight:bold">xsl:template</span>&gt;
&lt;/<span style="color:#309;font-weight:bold">xsl:stylesheet</span>&gt;
</code></pre></div><p>Refreshing the current event will show the <em>output</em> pane contains</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#099">&lt;?xml version=&#34;1.1&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span style="color:#309;font-weight:bold">&lt;Events</span> <span style="color:#309">xmlns=</span><span style="color:#c30">&#34;event-logging:3&#34;</span> <span style="color:#309">xmlns:stroom=</span><span style="color:#c30">&#34;stroom&#34;</span> <span style="color:#309">xmlns:xsi=</span><span style="color:#c30">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span style="color:#309">xmlns:xs=</span><span style="color:#c30">&#34;http://www.w3.org/2001/XMLSchema&#34;</span> <span style="color:#309">xsi:schemaLocation=</span><span style="color:#c30">&#34;event-logging:3 file://event-logging-v3.2.4.xsd&#34;</span> <span style="color:#309">Version=</span><span style="color:#c30">&#34;3.2.4&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
  <span style="color:#309;font-weight:bold">&lt;Event&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;EventTime&gt;</span>
      <span style="color:#309;font-weight:bold">&lt;TimeCreated&gt;</span>2005-05-04T17:16:12.000Z<span style="color:#309;font-weight:bold">&lt;/TimeCreated&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;/EventTime&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;EventSource&gt;</span>
      <span style="color:#309;font-weight:bold">&lt;System&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;Name&gt;</span>Site http://log-sharing.dreamhosters.com/ Bluecoat Logs<span style="color:#309;font-weight:bold">&lt;/Name&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;Environment&gt;</span>Development<span style="color:#309;font-weight:bold">&lt;/Environment&gt;</span>
      <span style="color:#309;font-weight:bold">&lt;/System&gt;</span>
      <span style="color:#309;font-weight:bold">&lt;Generator&gt;</span>Bluecoat Software: SGOS 3.2.4.28 Version: 1.0<span style="color:#309;font-weight:bold">&lt;/Generator&gt;</span>
      <span style="color:#309;font-weight:bold">&lt;Device&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;IPAddress&gt;</span>192.16.170.42<span style="color:#309;font-weight:bold">&lt;/IPAddress&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;Data</span> <span style="color:#309">Name=</span><span style="color:#c30">&#34;ServiceType&#34;</span> <span style="color:#309">Value=</span><span style="color:#c30">&#34;SG-HTTP-Service&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
      <span style="color:#309;font-weight:bold">&lt;/Device&gt;</span>
      <span style="color:#309;font-weight:bold">&lt;Client&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;IPAddress&gt;</span>45.110.2.82<span style="color:#309;font-weight:bold">&lt;/IPAddress&gt;</span>
      <span style="color:#309;font-weight:bold">&lt;/Client&gt;</span>
      <span style="color:#309;font-weight:bold">&lt;Server&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;HostName&gt;</span>www.inmobus.com<span style="color:#309;font-weight:bold">&lt;/HostName&gt;</span>
      <span style="color:#309;font-weight:bold">&lt;/Server&gt;</span>
      <span style="color:#309;font-weight:bold">&lt;User&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;Id&gt;</span>george<span style="color:#309;font-weight:bold">&lt;/Id&gt;</span>
      <span style="color:#309;font-weight:bold">&lt;/User&gt;</span>
      <span style="color:#309;font-weight:bold">&lt;Data</span> <span style="color:#309">Name=</span><span style="color:#c30">&#34;MyMeta&#34;</span> <span style="color:#309">Value=</span><span style="color:#c30">&#34;FQDN:somenode.strmdev00.org\nipaddress:192.168.2.220\nipaddress_eth0:192.168.2.220\nipaddress_lo:127.0.0.1\nipaddress_virbr0:192.168.122.1\n&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;/EventSource&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;EventDetail&gt;</span>
      <span style="color:#309;font-weight:bold">&lt;TypeId&gt;</span>Bluecoat-GET-http<span style="color:#309;font-weight:bold">&lt;/TypeId&gt;</span>
      <span style="color:#309;font-weight:bold">&lt;Description&gt;</span>Receipt of information from a Resource via Proxy<span style="color:#309;font-weight:bold">&lt;/Description&gt;</span>
      <span style="color:#309;font-weight:bold">&lt;Receive&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;Source&gt;</span>
          <span style="color:#309;font-weight:bold">&lt;Device&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;IPAddress&gt;</span>45.110.2.82<span style="color:#309;font-weight:bold">&lt;/IPAddress&gt;</span>
          <span style="color:#309;font-weight:bold">&lt;/Device&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;/Source&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;Destination&gt;</span>
          <span style="color:#309;font-weight:bold">&lt;Device&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;HostName&gt;</span>www.inmobus.com<span style="color:#309;font-weight:bold">&lt;/HostName&gt;</span>
          <span style="color:#309;font-weight:bold">&lt;/Device&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;/Destination&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;Payload&gt;</span>
          <span style="color:#309;font-weight:bold">&lt;Resource&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;URL&gt;</span>http://www.inmobus.com/wcm/assets/images/imagefileicon.gif<span style="color:#309;font-weight:bold">&lt;/URL&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;HTTPMethod&gt;</span>GET<span style="color:#309;font-weight:bold">&lt;/HTTPMethod&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;UserAgent&gt;</span>Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)<span style="color:#309;font-weight:bold">&lt;/UserAgent&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;InboundSize&gt;</span>941<span style="color:#309;font-weight:bold">&lt;/InboundSize&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;OutboundSize&gt;</span>729<span style="color:#309;font-weight:bold">&lt;/OutboundSize&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;RequestTime&gt;</span>1<span style="color:#309;font-weight:bold">&lt;/RequestTime&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;ResponseCode&gt;</span>200<span style="color:#309;font-weight:bold">&lt;/ResponseCode&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;MimeType&gt;</span>image/gif<span style="color:#309;font-weight:bold">&lt;/MimeType&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;Data</span> <span style="color:#309">Name=</span><span style="color:#c30">&#34;s-action&#34;</span> <span style="color:#309">Value=</span><span style="color:#c30">&#34;TCP_HIT&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;Data</span> <span style="color:#309">Name=</span><span style="color:#c30">&#34;cs-uri-scheme&#34;</span> <span style="color:#309">Value=</span><span style="color:#c30">&#34;http&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;Data</span> <span style="color:#309">Name=</span><span style="color:#c30">&#34;s-hierarchy&#34;</span> <span style="color:#309">Value=</span><span style="color:#c30">&#34;DIRECT&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;Data</span> <span style="color:#309">Name=</span><span style="color:#c30">&#34;sc-filter-result&#34;</span> <span style="color:#309">Value=</span><span style="color:#c30">&#34;PROXIED&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
            <span style="color:#309;font-weight:bold">&lt;Data</span> <span style="color:#309">Name=</span><span style="color:#c30">&#34;x-icap-error-code&#34;</span> <span style="color:#309">Value=</span><span style="color:#c30">&#34;none&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
          <span style="color:#309;font-weight:bold">&lt;/Resource&gt;</span>
        <span style="color:#309;font-weight:bold">&lt;/Payload&gt;</span>
      <span style="color:#309;font-weight:bold">&lt;/Receive&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;/EventDetail&gt;</span>
  <span style="color:#309;font-weight:bold">&lt;/Event&gt;</span>
<span style="color:#309;font-weight:bold">&lt;/Events&gt;</span>
</code></pre></div><p>for the given input</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#099">&lt;?xml version=&#34;1.1&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span style="color:#309;font-weight:bold">&lt;records</span> <span style="color:#309">xmlns=</span><span style="color:#c30">&#34;records:2&#34;</span> <span style="color:#309">xmlns:xsi=</span><span style="color:#c30">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span style="color:#309">xsi:schemaLocation=</span><span style="color:#c30">&#34;records:2 file://records-v2.0.xsd&#34;</span> <span style="color:#309">version=</span><span style="color:#c30">&#34;2.0&#34;</span><span style="color:#309;font-weight:bold">&gt;</span>
  <span style="color:#309;font-weight:bold">&lt;record&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;date&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;2005-05-04&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;time&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;17:16:12&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;time-taken&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;1&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;c-ip&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;45.110.2.82&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;sc-status&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;200&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;s-action&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;TCP_HIT&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;sc-bytes&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;941&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;cs-bytes&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;729&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;cs-method&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;GET&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;cs-uri-scheme&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;http&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;cs-host&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;www.inmobus.com&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;cs-uri-path&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;/wcm/assets/images/imagefileicon.gif&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;cs-uri-query&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;-&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;cs-username&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;george&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;s-hierarchy&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;DIRECT&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;s-supplier-name&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;38.112.92.20&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;rs(Content-Type)&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;image/gif&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;cs(User-Agent)&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;sc-filter-result&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;PROXIED&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;sc-filter-category&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;none&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;x-virus-id&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;-&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;s-ip&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;192.16.170.42&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;s-sitename&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;SG-HTTP-Service&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;x-virus-details&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;-&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;x-icap-error-code&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;none&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
    <span style="color:#309;font-weight:bold">&lt;data</span> <span style="color:#309">name=</span><span style="color:#c30">&#34;x-icap-error-details&#34;</span> <span style="color:#309">value=</span><span style="color:#c30">&#34;-&#34;</span> <span style="color:#309;font-weight:bold">/&gt;</span>
  <span style="color:#309;font-weight:bold">&lt;/record&gt;</span>
<span style="color:#309;font-weight:bold">&lt;/records&gt;</span>
</code></pre></div><p>Do not forget to Save <img src="../resources/icons/save.png" alt="Save" title="Save"> the translation as we are complete.</p>
<h4 id="schema-validation">Schema Validation</h4>
<p>One last point, validating the use of the Stroom Event Logging Schema is performed in the <code>schemaFilter</code> component of the pipeline. Had our translation resulted in a malformed Event, this pipeline component displays any errors. In the screen below, we have purposely changed the <code>EventTime/TimeCreated</code> element to be <code>EventTime/TimeCreatd</code>. If one selects the <code>schemaFilter</code> component and then Refresh <img src="../resources/icons/stepRefresh.png" alt="stepRefresh" title="Refresh Current Step"> the current step, we will see that</p>
<ul>
<li>there is an error as indicated by a square <strong>Red</strong> box <img src="../resources/icons/errorIndicator.png" alt="errorIndicator" title="Error Indicator"> in the top right hand corner</li>
<li>there is a <strong>Red</strong> rectangle line indicator mark <img src="../resources/icons/errorLine.png" alt="errorLine" title="Error Line Indicator"> on the right hand side in the display slide bar</li>
<li>there is a <strong>Red</strong> error marker <img src="../resources/icons/errorMarker.png" alt="errorMarker" title="Error Marker"> on the left hand side</li>
</ul>
<p><img src="../resources/UI-FeedProcessing-47.png" alt="Stroom UI Create Feed - Translation - Stepping XSLT Translation 6" title="Stroom UI Create Feed - Translation - Stepping XSLT Translation 6"></p>
<p>Hovering over the error marker <img src="../resources/icons/errorMarker.png" alt="errorMarker" title="Error Marker"> on the left hand side will bring a pop-up describing the error.</p>
<p><img src="../resources/UI-FeedProcessing-48.png" alt="Stroom UI Create Feed - Translation - Stepping XSLT Translation 7" title="Stroom UI Create Feed - Translation - Stepping XSLT Translation 7"></p>
<p>At this point, close the <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> stepping tab, acknowledging you do not want to save your errant changes</p>
<p><img src="../resources/UI-FeedProcessing-49.png" alt="Stroom UI Create Feed - Translation - Stepping XSLT Translation 8" title="Stroom UI Create Feed - Translation - Stepping XSLT Translation 8"></p>
<p>by pressing the <img src="../resources/icons/buttonOk.png" alt="Stroom UI OkButton" title="Stroom UI OkButton"> button.</p>
<h1 id="automated-processing">Automated Processing</h1>
<p>Now that we have authored our translation, we want to enable Stroom to automatically process streams of raw event log data as it arrives. We do this by configuring a <code>Processor</code> in the <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> <code>pipeline</code>.</p>
<h2 id="adding-a-pipeline-processor">Adding a Pipeline Processor</h2>
<p>Open the <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> <code>pipeline</code> by selecting it (<em>double left click</em>) in the <code>Explorer</code> display to show</p>
<p><img src="../resources/UI-FeedProcessing-50.png" alt="Stroom UI Enable Processing" title="Stroom UI Enable Processing"></p>
<p>To configure a Processor we select the <code>Processors</code> hyper-link of the *<em>BlueCoat-Proxy-V1.0-EVENTS</em> <code>Pipeline</code> tab to reveal</p>
<p><img src="../resources/UI-FeedProcessing-51.png" alt="Stroom UI Enable Processing - Processors table" title="Stroom UI Enable Processing - Processors table"></p>
<p>We add a Processor by pressing the add processor button <img src="../resources/icons/add.png" alt="Add Processor" title="Add Processor"> in the top left hand corner. At this you will be presented with an <code>Add Filter</code> configuration window.</p>
<p><img src="../resources/UI-FeedProcessing-52.png" alt="Stroom UI Enable Processing - Add filter 1" title="Stroom UI Enable Processing - Add Filter 1"></p>
<p>As we wish to create a Processor that will automatically process all <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> feed <code>Raw Events</code> we will select the BlueCoat-Proxy-V1.0-EVENTS <code>Feed</code> and Raw Event <code>Stream Type</code>.</p>
<p>To select the feed, we press the <code>Edit</code> button <img src="../resources/icons/edit.png" alt="Stroom UI Edit Feed Filter" title="Stroom UI EditButton">.  At this, the <code>Choose Feeds To Include And Exclude</code> configuration window is displayed.</p>
<p><img src="../resources/UI-FeedProcessing-53.png" alt="Stroom UI Enable Processing - Add filter 2" title="Stroom UI Enable Processing - Add Filter 2"></p>
<p>As we need to <code>Include</code> the BlueCoat-Proxy-V1.0-EVENTS <code>Feed</code> in our selection, press the <img src="../resources/icons/add.png" alt="Add" title="Add"> button in the <code>Include:</code> pane of the window to be presented with a <code>Choose Item</code> configuration window.</p>
<p><img src="../resources/UI-FeedProcessing-54.png" alt="Stroom UI Enable Processing - Add filter 3" title="Stroom UI Enable Processing - Add Filter 3"></p>
<p>Navigate to the <strong>Event Sources/Proxy/BlueCoat</strong> folder and select the <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> <code>Feed</code></p>
<p><img src="../resources/UI-FeedProcessing-55.png" alt="Stroom UI Enable Processing - Add filter 4" title="Stroom UI Enable Processing - Add Filter 4"></p>
<p>then press the <img src="../resources/icons/buttonOk.png" alt="Stroom UI OkButton" title="Stroom UI OkButton"> button to select and see that the feed is included.</p>
<p><img src="../resources/UI-FeedProcessing-56.png" alt="Stroom UI Enable Processing - Add filter 5" title="Stroom UI Enable Processing - Add Filter 5"></p>
<p>Again press the <img src="../resources/icons/buttonOk.png" alt="Stroom UI OkButton" title="Stroom UI OkButton"> button to close the <code>Choose Feeds To Include And Exclude</code> window to show that we have selected our feed in the <code>Feeds:</code> selection pane of the <code>Add Filter</code> configuration window.</p>
<p><img src="../resources/UI-FeedProcessing-57.png" alt="Stroom UI Enable Processing - Add filter 6" title="Stroom UI Enable Processing - Add Filter 6"></p>
<p>We now need to select our <code>Stream Type</code>. Press the <img src="../resources/icons/add.png" alt="Add" title="Add"> button in the <code>Stream Types:</code> pane of the window to be presented with a <code>Add Stream Type</code> window with a <code>Stream Type:</code> selection drop down.</p>
<p><img src="../resources/UI-FeedProcessing-58.png" alt="Stroom UI Enable Processing - Add filter 7" title="Stroom UI Enable Processing - Add Filter 7"></p>
<p>We select (<em>left click</em>) the drop down selection to display the types of Stream we can choose</p>
<p><img src="../resources/UI-FeedProcessing-59.png" alt="Stroom UI Enable Processing - Add filter 8" title="Stroom UI Enable Processing - Add Filter 8"></p>
<p>and as we are selecting <code>Raw Events</code> we select that item then press the <img src="../resources/icons/buttonOk.png" alt="Stroom UI OkButton" title="Stroom UI OkButton"> button at which we see that our <code>Add Filter</code> configuration window displays</p>
<p><img src="../resources/UI-FeedProcessing-60.png" alt="Stroom UI Enable Processing - Add filter 9" title="Stroom UI Enable Processing - Add Filter 9">.</p>
<p>As we have selected our filter items, press the <img src="../resources/icons/buttonOk.png" alt="Stroom UI OkButton" title="Stroom UI OkButton"> button to display our configured Processors.</p>
<p><img src="../resources/UI-FeedProcessing-61.png" alt="Stroom UI Enable Processing - Configured Processors" title="Stroom UI Enable Processing - Configured Processors">.</p>
<p>We now see our display is divided into two panes. The Processors table pane at the top and the specific Processor pane below. In our case, our filter selection has left the <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> <code>Filter</code> selected in the Processors table</p>
<p><img src="../resources/UI-FeedProcessing-62.png" alt="Stroom UI Enable Processing - Configured Processors - Selected Processor" title="Stroom UI Enable Processing - Configured Processors - Selected Processor">.</p>
<p>and the specific filter&rsquo;s details in the bottom pane.</p>
<p><img src="../resources/UI-FeedProcessing-63.png" alt="Stroom UI Enable Processing - Configured Processors - Selected Processor Detail" title="Stroom UI Enable Processing - Configured Processors - Selected Processor Detail">.</p>
<p>The column entries in the Processors Table pane describe</p>
<ul>
<li>Pipeline - the name of the Processor pipeline (<img src="../resources/icons/pipeline.png" alt="Pipeline" title="Pipeline">) or Processor filter (<img src="../resources/icons/filter.png" alt="Filter" title="Filter">)</li>
<li>Tracker Ms - the last time the tracker updated</li>
<li>Tracker % - the percentage of available streams completed</li>
<li>Last Poll Age - the last time the processor found new streams to process</li>
<li>Task Count - the number of processor tasks currently running</li>
<li>Priority - the queue scheduling priority of task submission to available stream processors</li>
<li>Streams - the number of streams that have been processed (includes currently running streams)</li>
<li>Events - ??</li>
<li>Status - the status of the processor. Normally empty if the number of stream is open-ended. If only are subset of streams were chosen (e.g. a time range in the filter) then the status will be <em>Complete</em></li>
<li>Enabled - check box to indicate the processor is enabled</li>
</ul>
<p>We now need only <code>Enable</code> both the pipeline Processor and the pipeline Filter for automatic processing to occur. We do this by selecting both check boxes in the <code>Enabled</code> column.</p>
<p><img src="../resources/UI-FeedProcessing-64.png" alt="Stroom UI Enable Processing - Configured Processors - Enable Processor" title="Stroom UI Enable Processing - Configured Processors - Enable Processor"></p>
<p>If we refresh our Processor table by pressing the <img src="../resources/icons/refresh.png" alt="Stroom UI Refresh" title="Stroom UI RefreshButton"> button in the top right hand corner, we will see that more table entries have been filled in.</p>
<p><img src="../resources/UI-FeedProcessing-65.png" alt="Stroom UI Enable Processing - Configured Processors - Enable Processor Result" title="Stroom UI Enable Processing - Configured Processors - Enable Processor Result"></p>
<p>We see that the tracker last updated at <em>2018-07-14T04:00:35.289Z</em>, the percentage complete is <em>100</em> (we only had one stream after all), the last time active streams were checked for was <em>2.3</em> minutes ago, there are no tasks running and that <em>1</em> stream has completed. Note that the <code>Status</code> column is blank as we have an <em>open ended</em> filter in that the processor will continue to select and process any new stream of <code>Raw Events</code> coming into the <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> feed.</p>
<p>If we return to the <em>BlueCoat-Proxy-V1.0-EVENTS</em>* <code>Feed</code> tab, ensuring the **Data** hyper-link is selected and then refresh (<img src="../resources/icons/refresh.png" alt="Refresh" title="Refresh">) the top pane that holds the summary of the latest Feed streams</p>
<p><img src="../resources/UI-FeedProcessing-66.png" alt="Stroom UI Enable Processing - Configured Processors - Feed Display" title="Stroom UI Enable Processing - Configured Processors - Feed Display"></p>
<p>We see a new entry in the table. The columns display</p>
<ul>
<li>Created - The time the stream was created.</li>
<li>Type - The type of stream. Our new entry has a type of &lsquo;Events&rsquo; as we have processed our <code>Raw Events</code> data.</li>
<li>Feed - The name of the stream&rsquo;s feed</li>
<li>Pipeline - The name of the pipeline involved in the generation of the stream</li>
<li>Raw - The size in bytes of the raw stream data</li>
<li>Disk - The size in bytes of the raw stream data when stored in compressed form on the disk</li>
<li>Read - The number of records read by a pipeline</li>
<li>Write - The number of records (events) written by a pipeline. In this case the difference is that we did not generate events for the <code>Software</code> or <code>Version</code> records we read.</li>
<li>Fatal - The number of fatal errors the pipeline encountered when processing this stream</li>
<li>Error - The number of errors the pipeline encountered when processing this stream</li>
<li>Warn - The number of warnings the pipeline encountered when processing this stream</li>
<li>Info - The number of informational alerts the pipeline encountered when processing this stream</li>
<li>Retention - The retention period for this stream of data</li>
</ul>
<p>If we also refresh (<img src="../resources/icons/refresh.png" alt="Refresh" title="Refresh">) the specific feed pane (middle) we again see a new entry of the <code>Events</code> <em>Type</em></p>
<p><img src="../resources/UI-FeedProcessing-67.png" alt="Stroom UI Enable Processing - Configured Processors - Specific Feed Display" title="Stroom UI Enable Processing - Configured Processors - Specific Feed Display"></p>
<p>If we select (<em>left click</em>) on the <code>Events</code> <em>Type</em> in either pane, we will see that the data pane displays the first event in the <em>GCHQ Stroom Event Logging XML Schema</em> form.</p>
<p><img src="../resources/UI-FeedProcessing-68.png" alt="Stroom UI Enable Processing - Configured Processors - Event Display" title="Stroom UI Enable Processing - Configured Processors - Event Display"></p>
<p>We can now send a file of BlueCoat Proxy logs to our Stroom instance from a Linux host using <em>curl</em> command and see how Stroom will automatically processes the file. Use the command</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">curl -k --data-binary @sampleBluecoat.log https://stroomp.strmdev00.org/stroom/datafeed -H<span style="color:#c30">&#34;Feed:BlueCoat-Proxy-V1.0-EVENTS&#34;</span> -H<span style="color:#c30">&#34;Environment:Development&#34;</span>  -H<span style="color:#c30">&#34;LogFileName:sampleBluecoat.log&#34;</span> -H<span style="color:#c30">&#34;MyHost:\&#34;somenode.strmdev00.org\&#34;&#34;</span> -H<span style="color:#c30">&#34;MyIPaddress:\&#34;192.168.2.220 192.168.122.1\&#34;&#34;</span> -H<span style="color:#c30">&#34;System:Site http://log-sharing.dreamhosters.com/ Bluecoat Logs&#34;</span> -H<span style="color:#c30">&#34;Version:V1.0&#34;</span>
</code></pre></div><p>After Stroom&rsquo;s Proxy aggregation has occurred, we will see that the new file posted via <em>curl</em> has been loaded into Stroom as per</p>
<p><img src="../resources/UI-FeedProcessing-69.png" alt="Stroom UI Enable Processing - Configured Processors - New Posted Stream" title="Stroom UI Enable Processing - Configured Processors - New Posted Stream"></p>
<p>and this new <em>Raw Event</em> stream is automatically processed a few seconds later as per</p>
<p><img src="../resources/UI-FeedProcessing-70.png" alt="Stroom UI Enable Processing - Configured Processors - New Posted Stream Processed" title="Stroom UI Enable Processing - Configured Processors - New Posted Stream Processed"></p>
<p>We note that since we have used the same sample file again, the Stream sizes and record counts are the same.</p>
<p>If we switch to the <code>Processors</code> tab of the pipeline we see that the Tracker timestamp has changed and the number of Streams processed has increased.</p>
<p><img src="../resources/UI-FeedProcessing-71.png" alt="Stroom UI Enable Processing - Configured Processors - New Posted Stream Processors" title="Stroom UI Enable Processing - Configured Processors - New Posted Stream Processors"></p>

</div>



    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/gchq/stroom" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2021 Crown Copyright 2021 All Rights Reserved</small>
        
	
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" integrity="sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF" crossorigin="anonymous"></script>






 













<script src="/stroom-docs/hugo-docsy/js/main.min.3b172c13b62c2bea8b1c9d2599cddc8cf89718a92d792c680871c81ba43d8c85.js" integrity="sha256-OxcsE7YsK&#43;qLHJ0lmc3cjPiXGKkteSxoCHHIG6Q9jIU=" crossorigin="anonymous"></script>




  </body>
</html>
